---
title: "ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œê³¼ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ"
date: 2023-08-02 23:30:00 +0900
tags:
  - Java
  - Architecture
emoji: ğŸ’»
author: ê°œë°œí•œì…
categories: ê°œë°œ
---

```toc
```

# ê°œìš”

ì‚¬ì‹¤ ì˜ˆì „ë¶€í„° ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œê³¼ ìŠ¤íŠ¸ë¦¼ì¦ˆì— ëŒ€í•œ ê¸€ì€ ì¤€ë¹„ë¥¼ í•˜ê³  ìˆì—ˆë‹¤.
ì´ˆì•ˆê¹Œì§€ ì–´ëŠì •ë„ ë§Œë“¤ì–´ ë‘” ìƒíƒœì˜€ëŠ”ë° ë‹¤ ê°ˆì•„ì—ê³  ë‹¤ì‹œ ì“°ê²Œë˜ì—ˆë‹¤.

ê·¸ ì´ìœ ëŠ” ë°”ë¡œ ì•„ë˜ì˜ ì±… ë•Œë¬¸ì´ë‹¤.

<p align="center">
    <img src="./book.jpeg">
</p>
<p align="center">
    <em><a href="https://www.yes24.com/Product/Goods/118202569">ê·¸ë¦¼ 1. ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, í™©ì •ì‹ ì €, 2023</a></em>
</p>

ì‚¬ì‹¤ êµ­ë‚´ ë²ˆì—­ì„œ ì¤‘ì—ì„œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì„ ì¢€ ì˜ ë‹¤ë£¬ ì±…ì€ ì°¾ê¸°ê°€ í˜ë“¤ì—ˆì—ˆë‹¤.
ê·¸ë˜ì„œ, ì›ë˜ ì´ˆì•ˆì€ ì•„ë˜ì˜ ì±…ì„ ì°¸ê³ í•˜ê³ , ê³µì‹ë¬¸ì„œë“¤ì„ ì°¸ê³ í•´ì„œ ì‘ì„±í•˜ê³  ìˆì—ˆë‹¤.

+ [Hands-On Reactive Programming in Spring 5, Igor Lozynskyi, 2018](https://www.amazon.com/Hands-Reactive-Programming-Spring-cloud-ready-ebook/dp/B076QCBXZ2)

ì´ ì±…ë„ ë§¤ìš° ì˜ì“°ì—¬ì§„ ì±…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ìœ„ ì±…ê³¼ ë¹„êµí•˜ë©´ ì € ì›ì„œì˜ ê²½ìš°ì—ëŠ” ê±°ì‹œì ì¸ ê´€ì ì—ì„œ ì‘ì„±ë˜ì—ˆë‹¤ë©´, í™©ì •ì‹ë‹˜ê»˜ì„œ ì‘ì„±í•˜ì‹  ì±…ì€ ë¯¸ì‹œì ì¸ ê´€ì ì˜ ì±…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤. 

ì´ í¬ìŠ¤íŒ…ì˜ ë‚´ìš© ëŒ€ë¶€ë¶„ì€ ë‘ ê°€ì§€ ì±…ê³¼ ê³µì‹ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì˜€ë‹¤.

ì˜ˆì‹œ ì½”ë“œëŠ” ì•„ë˜ì˜ ë ˆí¬ì§€í† ë¦¬ë“¤ì„ ì°¸ê³ ë°”ë€ë‹¤.
1. [blog-exampl/reactive-examples](https://github.com/brewagebear/blog-example/tree/main/reactive-examples)
2. [Hands-On-Reactive-Programming-in-Spring-5](https://github.com/PacktPublishing/Hands-On-Reactive-Programming-in-Spring-5)
3. [String-Reactive](https://github.com/bjpublic/Spring-Reactive)


## STEP 2. ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œê³¼ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë° 

### STEP 2.1 ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì´ë€?

ìš”ì¦˜ë‚  í”„ë¡œê·¸ë˜ë° ì„¸ê³„ì—ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œë¼ëŠ” ë§ì´ ìˆ˜ë„ ì—†ì´ ë§ì´ ê±°ë¡ ë˜ê³  ìˆë‹¤.
í•˜ì§€ë§Œ, ì •ì‘ ë¦¬ì•¡í‹°ë¸Œ(Reactive)ë¼ëŠ” ë‹¨ì–´ ìì²´ì— ëŒ€í•œ ëª¨í˜¸í•¨ë•Œë¬¸ì— ì •í™•íˆ ì–´ë– í•œ ì‹œìŠ¤í…œì¸ì§€ ê°ì„ ì¡ê¸°ê°€ í˜ë“¤ë‹¤.

ì‹¤ìƒí™œì˜ ì˜ˆì—ì„œ ì°¾ì•„ë³´ì. ì˜ˆëŠ¥ì´ë‚˜ í† í¬ì‡¼ í”„ë¡œê·¸ë¨ì„ ë³´ë©´ MCë“¤ì´ ê²ŒìŠ¤íŠ¸ë“¤ì—ê²Œ ë¦¬ì•¡ì…˜ì„ ì˜í•œë‹¤ê³  í•œë‹¤.
ê·¸ë ‡ë‹¤ë©´ ë¦¬ì•¡ì…˜ì€ ì–´ë–¤ ê²ƒì¼ê¹Œ? í™”ìì˜ ì–˜ê¸°ë¥¼ ì²­ì·¨í•˜ê³  ë§ì¥êµ¬ë¥¼ ì˜ ì³ì£¼ëŠ” í–‰ìœ„ë¥¼ ë¦¬ì•¡ì…˜ì´ë¼ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œë„ ê·¸ëŸ° ë§¥ë½ì—ì„œ ë³´ë©´, **ë°˜ì‘ì„ ì˜í•˜ëŠ” ì‹œìŠ¤í…œ**ì´ë¼ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.
í•˜ì§€ë§Œ, ì•„ì§ê¹Œì§€ë„ ëª¨í˜¸í•˜ë‹¤. ë°˜ì‘ì„ ì˜í•œë‹¤ëŠ” ëœ»ì€ ì–´ë–¤ ê²ƒì¼ê¹Œ? 

ì•„ë§ˆë„ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ì˜ ê´€ì ì—ì„œ ë³¸ë‹¤ë©´ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ëŒ€í•´ì„œ ë¹ ë¥´ê²Œ ì‘ë‹µí•´ì£¼ëŠ” ì‹œìŠ¤í…œì¼ ê²ƒì´ë‹¤.
ì´ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

> í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ì¦‰ê°ì ìœ¼ë¡œ ì‘ë‹µí•¨ìœ¼ë¡œì¨ ì§€ì—° ì‹œê°„ì„ ìµœì†Œí™”í•˜ëŠ” ì‹œìŠ¤í…œ 
> - ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, Kevin, p.28 -

ê·¸ë ‡ë‹¤ë©´ ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì€ ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ ì–´ë– í•œ ì°¨ì´ë¥¼ í†µí•´ì„œ ìœ„ì—ì„œ ë§í•œ ëª©í‘œë¥¼ ì´ë£¨ê³ ìí•˜ëŠ” ê²ƒì¼ê¹Œ?
ì´ë¥¼ ì•Œê¸° ìœ„í•´ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œ ì„ ì–¸ë¬¸ì„ ë´ì•¼í•œë‹¤.


<p align="center">
    <img src="https://i.imgur.com/QSlsWcn.png">
</p>
<p align="center">
    <em>ê·¸ë¦¼ 2. ë¦¬ì•¡í‹°ë¸Œ ì„ ì–¸ë¬¸</em>
</p>

ìœ„ ë„í‘œë¥¼ ì„¤ëª…í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤. 

+ MEANS(ë°©ë²•) : ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì—ì„œ ì£¼ìš” í†µì‹  ìˆ˜ë‹¨ì„ ë¬´ì—‡ì„ ì‚¬ìš©í• ì§€ë¥¼ í‘œí˜„í•œ ê²ƒìœ¼ë¡œ, ë¹„ë™ê¸° ë©”ì‹œì§€ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•œë‹¤.
+ FORM(í˜•íƒœ) : ë¹„ë™ê¸° ë©”ì‹œì§€ í†µì‹  ê¸°ë°˜í•˜ì— ì‹œìŠ¤í…œì˜ ë³€í™”í•˜ëŠ” ì‘ì—…ëŸ‰ì— íƒ„ë ¥ì ìœ¼ë¡œ ëŒ€ì‘í•˜ê³ , ì¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ì‘ë‹µì„±ì„ ìœ ì§€í•˜ëŠ” ê²ƒì„ ëœ»í•œë‹¤.
	+ Elasticity(íƒ„ë ¥ì„±) : ìœ ì…ë˜ëŠ” ì…ë ¥ì´ ë§ë“  ì ë“  ê°„ì— ì‹œìŠ¤í…œì´ ìš”êµ¬í•˜ëŠ” ì‘ë‹µì„±ì„ ì¼ì •í•˜ê²Œ ìœ ì§€
	+ Resilient(íšŒë³µì„±) : ë¹„ë™ê¸° ë©”ì‹œì§€ ê¸°ë°˜ í†µì‹ ì„ ì´ìš©í•˜ì—¬ ë‚®ì•„ì§„ ê²°í•©ë„ ë•ë¶„ì— ì¥ì• ê°€ ë°œìƒí•´ë„ ì „ì²´ ì‹œìŠ¤í…œì€ ì‘ë‹µ ê°€ëŠ¥í•˜ë©°, ì¥ì• ê°€ ë°œìƒí•œ ë¶€ë¶„ë§Œ ë³µêµ¬í•˜ë©´ ëœë‹¤.
+ VALUE(ê°€ì¹˜) : ìœ„ì—ì„œ ë‚˜ì˜¨ MEANS + FORMì„ í†µí•´ì„œ ì¦‰ê°ì ìœ¼ë¡œ ì‘ë‹µ ê°€ëŠ¥í•œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸

ì„ ì–¸ë¬¸ì˜ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´, **ë¹„ë™ê¸° ë©”ì‹œì§€ ê¸°ë°˜ í†µì‹ ì„ í™œìš©í•˜ì—¬ íƒ„ë ¥ì„±ê³¼ íšŒë³µì„±ì„ í† ëŒ€ë¡œ ì‹œìŠ¤í…œì´ ìš”êµ¬í•˜ëŠ” ì¼ì • ìˆ˜ì¹˜ì˜ ì‘ë‹µì„±ì„ ìœ ì§€í•˜ëŠ” ê²¬ê³ í•œ ì‹œìŠ¤í…œ**ì´ë¼ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œ ì•„ì§ë„ ì•ˆ ì™€ë‹¿ëŠ” ë…ìë¶„ë“¤ì´ ê³„ì‹¤êº¼ë¼ ìƒê°í•˜ì—¬, ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ì„¤ëª…í•´ë³´ê² ë‹¤.

í•„ìëŠ” ë¯¸êµ­ì—ì„œ ìˆ˜ì…ëŒ€í–‰ì„ í•˜ëŠ” ì‘ì€ ì§êµ¬ ìŠ¤í† ì–´ë¥¼ ê°œì—…ì„ í•˜ì˜€ë‹¤.
ì‹œê°„ì´ ê°ˆìˆ˜ë¡ ì¥ì‚¬ëŠ” ê½¤ ì˜ë˜ì—ˆê³ , ì‹œê°„ë‹¹ ì•½ 1000ëª…ì˜ ì‚¬ìš©ìê°€ ë°©ë¬¸í•˜ê²Œ ë˜ì—ˆë‹¤.

ê·¸ë˜ì„œ í•„ìëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì— Tomcat ì„œë²„ë¥¼ êµ¬ì¶•í•˜ì˜€ê³ , ì“°ë ˆë“œ í’€ì€ 500ê°œ ì •ë„ë¡œ í• ë‹¹í•´ë‘ì—ˆë‹¤.
ëŒ€ë‹¤ìˆ˜ì˜ ì‚¬ìš©ìì˜ ìš”ì²­ì˜ í‰ê·  ì‘ë‹µ ì‹œê°„ì€ ì•½ 250ë°€ë¦¬ì´ˆì˜€ë‹¤.  

$$TPS(Transaction\ Per \ Second) = {500 \over 0.25} \approx 2,000$$

ìœ„ì™€ ê°™ì€ ê³µì‹ì— ë”°ë¼ ì´ˆë‹¹ 2,000ëª…ì˜ ìš”ì²­ì´ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ì˜€ë‹¤. 
ë”°ë¼ì„œ, í•´ë‹¹ ì„œë²„ëŠ” í‰ê· ì ì¸ ë¶€í•˜ì—ëŠ” ì¶©ë¶„í•´ë³´ì˜€ë‹¤. 

ê·¸ëŸ¬ë‚˜ ì´ ì‹œìŠ¤í…œì€ ì‹¤íŒ¨í•˜ì˜€ë‹¤. ê·¸ ì›ì¸ì€ ë°”ë¡œ **ë¸”ë™ í”„ë¼ì´ë°ì´**ì˜€ë‹¤. ë¸”ë™ í”„ë¼ì´ë°ì´ë•Œ ì˜ˆìƒì¹˜ ëª»í•œ ê³ ê°ë“¤ì´ ëª°ë¦¬ê¸° ì‹œì‘í•˜ì˜€ìœ¼ë©°, ì„œë²„ëŠ” í‰ê· ë¶€í•˜ë³´ë‹¤ ì‹¬í•œ ë¶€í•˜ë¥¼ ê²ªê²Œë˜ì—ˆê³ , ì´ì— ë”°ë¼ ì ì°¨ì ìœ¼ë¡œ ì“°ë ˆë“œ í’€ì´ ê³ ê°ˆë˜ì–´ ë§¤ìš° í° ì¥ì• ê°€ ë°œìƒí•˜ì˜€ë‹¤.

ì´ ì˜ˆì‹œëŠ” í•„ìê°€ ë‡Œí”¼ì…œë¡œ ì‘ì„±í•œ ê¸€ì´ ì•„ë‹ˆë¼ ì‹¤ì œë¡œ ì•„ë§ˆì¡´ê³¼ ì›”ë§ˆíŠ¸ë„ ê²ªì—ˆë˜ ë¬¸ì œì˜€ë‹¤.
1. [Amazon.com hit with outages - CNET](https://www.cnet.com/tech/tech-industry/amazon-com-hit-with-outages/)
2. [Amazon.com Goes Down, Loses $66,240 Per Minute - Forbes](https://www.forbes.com/sites/kellyclay/2013/08/19/amazon-com-goes-down-loses-66240-per-minute/?sh=2b7f445b495c)
3. [Walmart's Black Friday Disaster : Website Crippled, Violence In Stores - TechCrunch](https://techcrunch.com/2011/11/25/walmart-black-friday/?guccounter=1)

ì´ì œ ìš°ë¦¬ëŠ” **ì–´ë–»ê²Œ ì‘ë‹µí•´ì•¼í•  ê²ƒì¸ê°€?** ë¥¼ ê³ ë¯¼í•˜ê²Œ ë˜ì—ˆë‹¤. ìœ„ì˜ ì˜ˆì‹œì™€ ê°™ì´ ì˜¤ëŠ˜ë‚  ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì‚¬ìš©ìì˜ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì–´ë– í•œ ë³€í™”ì—ë„ ë°˜ì‘ì„ í•´ì•¼í•˜ëŠ” ê²ƒì´ë‹¤.

ì´ê²ƒì´ ë°”ë¡œ ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì´ ì§€í–¥í•˜ê³ ìí•˜ëŠ” ê°€ì¹˜ì´ë‹¤.
ê·¸ë ‡ë‹¤ë©´ íƒ„ë ¥ì„±ì€ ë¬´ì—‡ì¸ê°€? ìœ„ ì˜ˆì‹œì—ì„œ ë§Œì•½, ì‚¬ìš©ìê°€ ë§ì•„ì¡Œì„ ë•Œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ìˆ˜ìš©ëŠ¥ë ¥ì´ ì¦ê°€ê°€ ë˜ì—ˆìœ¼ë©´ ì–´ë• ì„ê¹Œ? ë²„í‹¸ ìˆ˜ë„ ìˆì§€ ì•Šì•˜ì„ê¹Œ? 

ì´ê²ƒì´ ë°”ë¡œ **íƒ„ë ¥ì„±(Elastcity)** ì´ë‹¤. ìˆ˜ìš”ê°€ ì¦ê°€í–ˆì„ ë•Œ ì‹œìŠ¤í…œì„ í™•ì¥í•˜ê³ , ìˆ˜ìš”ê°€ ê°ì†Œë˜ì—ˆì„ ë•Œ ì‹œìŠ¤í…œì„ ì¶•ì†Œí•˜ëŠ” ë“± íƒ„ë ¥ì ìœ¼ë¡œ ìš´ì˜í•˜ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ **íšŒë³µì„±(Resilience)** ëŠ” ì–´ë–¤ì‹ìœ¼ë¡œ ì´ë¤„ì§ˆ ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì  êµ¬ì„± ìš”ì†Œ(Component) ì‚¬ì´ì— ê²©ë¦¬ë¥¼ ì ìš©í•˜ì—¬ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤.

ìŠ¤í† ì–´ ì˜ˆì‹œë¥¼ ë“¤ì—ˆëŠ”ë° ìŠ¤í† ì–´ì—ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ ì¡´ì¬í•œë‹¤. ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥, ë¦¬ë·°ë¥¼ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ ë“± ë§ì´ë‹¤. 
ë§Œì•½, ë¦¬ë·°ë¥¼ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì´ ì¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì´ë‚˜ ê²°ì œ ê¸°ëŠ¥ì€ ë©€ì©¡í•˜ë‹¤ë©´ ê³ ê°ì€ ì¶©ë¶„íˆ ê³„ì†í•´ì„œ ì£¼ë¬¸ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. 

ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì´ ì§€í–¥í•˜ëŠ” ê°€ì¹˜ë¥¼ ì¶”êµ¬í•˜ê³ ìí•˜ë©´ ì´ ë‘ê°€ì§€ íŠ¹ì„±ì´ í•„ìš”ì¶©ë¶„ì¡°ê±´ì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„±ì„ ì–»ê¸° ìœ„í•´ì„œ ë©”ì‹œì§€-ì£¼ë„(Message-Driven) í†µì‹ ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.  ì™œ ë©”ì‹œì§€-ì£¼ë„ ë°©ì‹ì´ ì´ì™€ ì—°ê´€ì´ ë˜ì–´ìˆëŠ”ì§€ ê¶ê¸ˆí•˜ë‹¤ë©´ ì•„ë˜ì˜ ê¸€ì„ ì°¸ê³ í•´ë³´ì.

+ [ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ í†ºì•„ë³´ê¸°](https://brewagebear.github.io/overview-streaming-system/)

ì´ëŸ° ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì˜ ê°€ì¹˜ëŠ” ë‹¤ì–‘í•œ ê³³ì—ì„œ ì‚¬ìš©ë˜ê³  ìˆë‹¤. ìœ„ì—ì„œ ì–˜ê¸°í•œ ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œì˜ ì˜ˆì‹œë¥¼ ë³´ì.

<p align="center">
    <img src="https://i.imgur.com/LPcUSMs.png">
</p>
<p align="center">
    <em><a href="https://www.amazon.com/Hands-Reactive-Programming-Spring-cloud-ready-ebook/dp/B076QCBXZ2"> ê·¸ë¦¼ 3. ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜(Hands-On Reactive Programming in Spring 5, Igor Lozynskyi, 2018, p.71)</a></em>
</p>

ìŠ¤íŠ¸ë¦¬ë° ì•„ì´ì¼ì²˜ëŠ” ë°ì´í„° ì²˜ë¦¬ì™€ ë³€í™˜ì˜ íë¦„ì„ ì¤‘ì ì ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ì•„í‚¤í…ì²˜ë¡œ ì¤€ ì‹¤ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” ì‘ë‹µì„ ë‚´ë ¤ì¤˜ì•¼í•˜ê¸° ë•Œë¬¸ì—, ë‚®ì€ ì§€ì—°ì‹œê°„ê³¼ ë†’ì€ ì²˜ë¦¬ëŸ‰ì„ ì§€ë‹ˆëŠ” íŠ¹ì„±ì„ ê°€ì§„ë‹¤. ì´ëŸ¬í•œ íš¨ê³¼ì ì¸ ì‘ì—…ëŸ‰ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ë°°ì••(Backpressure)ë¼ëŠ” ê¸°ëŠ¥ì„ í†µí•´ì„œ í•´ë‹¹ ì•„í‚¤í…ì²˜ê°€ í•´ê²°í•˜ê³ ìí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìœ¼ë©°, ë©”ì‹œì§€ëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë¸Œë¡œì»¤(e.g ì¹´í”„ì¹´)ì™€ ê°™ì€ ê²ƒì„ í† ëŒ€ë¡œ ë©”ì‹œì§€ ê¸°ë°˜ í†µì‹ ì„ í†µí•´ì„œ í•´ë‹¹ ê°€ì¹˜ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤.

ì´ ë¿ë§Œ ì•„ë‹ˆë¼ ìœ„ì—ì„œ ì–˜ê¸°í•œ ìŠ¤í† ì–´ ì˜ˆì‹œì— ì ìš©í•˜ìë©´ ì•„ë˜ì™€ ê°™ì€ ê·¸ë¦¼ì²˜ëŸ¼ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

<p align="center">
    <img src="https://i.imgur.com/lMd9dhJ.png">
</p>
<p align="center">
    <em><a href="https://www.amazon.com/Hands-Reactive-Programming-Spring-cloud-ready-ebook/dp/B076QCBXZ2"> ê·¸ë¦¼ 4. ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜(Hands-On Reactive Programming in Spring 5, Igor Lozynskyi, 2018, p.69)</a></em>
</p>


ìœ„ì—ì„œ ì–¸ê¸‰í•œ íƒ„ë ¥ì„±ê³¼ íšŒë³µì„±ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•´ì„œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ì„ ì ìš©í•˜ì˜€ê³ , Kafkaê°™ì€ ë¸Œë¡œì»¤ë¥¼ ì´ìš©í•˜ì—¬ ì™¸ë¶€ ì‹œìŠ¤í…œ(PG, íŒë±…í‚¹)ì˜ ì˜í–¥ë„ë¥¼ ìµœì†Œí™”ì‹ í‚¤ëŠ” ì•„í‚¤í…ì²˜ë¡œ êµ¬ì„±í•˜ì—¬, ë‹¤ì‹œ ì¬ì‹œë„í•˜ëŠ” ì²˜ë¦¬ì‘ì—…ê¹Œì§€ í•´ë‘ì—ˆë‹¤. ì´ ë¿ë§Œ ì•„ë‹ˆë¼ ë°ì´í„°ë² ì´ìŠ¤ë„ ë§ˆìŠ¤í„°-ìŠ¬ë ˆì´ë¸Œ êµ¬ì¡°[^1] ë¥¼ ì±„íƒí•˜ì˜€ë‹¤. 

ì´ëŸ°ì‹ìœ¼ë¡œ ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì˜ ê°€ì¹˜ëŠ” ë‹¨ìˆœí•˜ê²Œ ë¦¬ì•¡í„°(Reactor)[^2] , ìŠ¤í”„ë§ í´ë¼ìš°ë“œ ìŠ¤íŠ¸ë¦¼(Spring Cloud Streams)[^3] ë‚˜ ìŠ¤í”„ë§ ì›¹í”ŒëŸ­ìŠ¤(Spring Webflux)[^4] ê°™ì€ ê¸°ìˆ ì— êµ­í•œëœ ê°œë…ì´ ì•„ë‹Œ ê²ƒì´ë‹¤.

### STEP 2.2 ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì´ë€?

ìœ„ì—ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì—ì„œ ì•Œì•„ë³´ì•˜ë‹¤. ê·¸ëŸ°ë° ì´ëŸ¬í•œ ì‹œìŠ¤í…œì„ ì–´ë–»ê²Œ í”„ë¡œê·¸ë˜ë°ì ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆì„ê¹Œ? 
ê·¸ê±°ì— ëŒ€í•œ í•´ê²°ì±…ì´ ë°”ë¡œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì´ë‹¤.

> ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë° í•„ìš”í•œ í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì´ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì´ë‹¤. 
> - ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, í™©ì •ì‹ ì €, p.30 -

ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ íŠ¹ì§•ì„ ì„¤ëª…í•˜ê¸° ì•ì„œ ì½”ë“œì˜ ë³€í™”ê³¼ì •ì„ ì‚´í´ë³¼ í•„ìš”ê°€ ìˆë‹¤.
ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì™€ ìë°” ì§„ì˜ì˜ ë³€í™”ì ì— ëŒ€í•´ì„œ ì¤‘ì ì ìœ¼ë¡œ ì‚´í´ë³¼ ê²ƒì´ë‹¤.

### STEP 2.2.1 Blocking I/Oì—ì„œ Non-Blocking I/Oë¡œ 

ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì.

#### STEP 2.2.1.1 ë¸”ë¡í‚¹ ì‹œë‚˜ë¦¬ì˜¤

```java
public interface ShoppingCardService {  
	Output calculate(Input value);  
}

public class BlockingShoppingCardService implements ShoppingCardService {  
	@Override  
	public Output calculate(Input value) {  
		try {  
			Thread.sleep(1000);  
		} catch (InterruptedException e) {  
			e.printStackTrace();  
		}  
		return new Output();  
	}  
}

public class OrdersService {  
	private final ShoppingCardService shoppingCardService;  
  
	public OrdersService(ShoppingCardService shoppingCardService) {  
		this.shoppingCardService = shoppingCardService;  
	}  
  
	void process() {  
		Input input = new Input();  
		Output output = shoppingCardService.calculate(input);  
  
		System.out.println(shoppingCardService.getClass().getSimpleName() + " execution completed");  
	}
}

public static void main(String[] args) {  
	long start = System.currentTimeMillis();  
  
	new OrdersService(new BlockingShoppingCardService()).process();  
	new OrdersService(new BlockingShoppingCardService()).process();  
  
	System.out.println("Total elapsed time in millis is : " + (System.currentTimeMillis() - start));  
}
```

ì•„ì£¼ ë‹¨ìˆœí•˜ê²Œ êµ¬í˜„ëœ ì½”ë“œë¡œ `OrderService`ì—ì„œ `ShoppingCardService`ë¥¼ í˜¸ì¶œí•œë‹¤ê³  ìƒê°í•´ì„œ ì§  ì½”ë“œì´ë‹¤.
`BlockingShoppingCardService`ëŠ” I/O ì‘ì—…ê°™ì´ ì¥ ì‹œê°„ ì†Œìš”ë˜ëŠ” ì‘ì—…ì´ ìˆë‹¤ ê°€ì •í•´ë³´ì. 

ê²°ê³¼ë¥¼ ë³´ë©´ 2ë²ˆì˜ `Thread.sleep(1000)` ì´ í˜¸ì¶œë  ê²ƒì´ë©°, ëŒ€ëµ 2ì´ˆì •ë„ ê±¸ë¦´ ê²ƒì´ë‹¤.
`calculate()` ë©”ì„œë“œë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì „ë‹¬ëœ ì“°ë ˆë“œëŠ” ë‹¹ì—°íˆ ë¸”ë¡í‚¹ì´ ë  ê²ƒì´ê³ , ì´ ì“°ë ˆë“œëŠ” 1ì´ˆë™ì•ˆ ì•„ë¬´ê²ƒë„ í•˜ì§€ ëª»í•˜ê²Œ ëœë‹¤.

ë”°ë¼ì„œ, `OrderService`ì—ì„œ `ShoppingCardService`ì— ìš”ì²­ ì´í›„ì— ë‹¤ë¥¸ ì‘ì—…ì„ í•˜ê³  ì‹¶ìœ¼ë©´ ì¶”ê°€ì ì¸ ì“°ë ˆë“œ í• ë‹¹ì´ í•„ìš”í•œ ìƒí™©ì´ë‹¤.
ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œ?

ë°”ë¡œ, ì½œë°±ì„ í†µí•´ì„œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

#### STEP 2.2.1.2 ì½œë°± ì‹œë‚˜ë¦¬ì˜¤

```java
public interface ShoppingCardService {  
	void calculate(Input value, Consumer<Output> consumer);  
}

// ë¹„ë™ê¸° ì„œë¹„ìŠ¤
public class AsyncShoppingCardService implements ShoppingCardService {  
	@Override  
	public void calculate(Input value, Consumer<Output> consumer) {  
		new Thread(() -> {  
			try {  
				Thread.sleep(1000);  
			} catch (InterruptedException e) {  
				e.printStackTrace();  
			}  
			consumer.accept(new Output());  
		}).start();  
	}  
}

// ë™ê¸° ì„œë¹„ìŠ¤ 
public class SyncShoppingCardService implements ShoppingCardService {  
	@Override  
	public void calculate(Input value, Consumer<Output> consumer) {  
		consumer.accept(new Output());  
	}  
}

public class OrdersService {  
	private final ShoppingCardService shoppingCardService;  
  
	public OrdersService(ShoppingCardService shoppingCardService) {  
		this.shoppingCardService = shoppingCardService;  
	}  
  
	void process() {  
		Input input = new Input();  
		shoppingCardService.calculate(input, output -> {  
			System.out.println(shoppingCardService.getClass().getSimpleName() + " execution completed");  
		});  
	}
}

public static void main(String[] args) throws InterruptedException {  
	long start = System.currentTimeMillis();  
  
	OrdersService ordersServiceAsync = new OrdersService(new AsyncShoppingCardService());  
	OrdersService ordersServiceSync = new OrdersService(new SyncShoppingCardService());  
  
	ordersServiceAsync.process();  
	ordersServiceAsync.process();  
	ordersServiceSync.process();  
  
	System.out.println("Total elapsed time in millis is : " + (System.currentTimeMillis() - start));  
  
	Thread.sleep(1000);  
}
```

`Consumer<T>` íƒ€ì…ìœ¼ë¡œ ì½œë°±ì„ ìƒì„±í•˜ì—¬, ë¹„ë™ê¸° ì„œë¹„ìŠ¤ì™€ ë™ê¸° ì„œë¹„ìŠ¤ë¥¼ ì‘ì—…í•˜ì˜€ë‹¤. 
`SyncShoppingCardService()`ëŠ” ë¸”ë¡í‚¹ ì‘ì—…ì´ ì—†ë‹¤ ê°€ì •í•˜ê³ , ë°”ë¡œ ì½œë°±ì— ë¦¬í„´ë˜ê²Œë” ì„¤ê³„ë˜ì—ˆë‹¤. 
`ASyncShoppingCardService()`ëŠ” ë¸”ë¡í‚¹ ì‘ì—…ì´ ì¡´ì¬í•´ë„, ìƒˆë¡œìš´ ì“°ë ˆë“œë¡œ ê°ì‹¸ì„œ `OrderService`ì—ì„œ ì½œë°±ì„ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œë” í•´ì¤€ë‹¤. 

ê¸°ì¡´ 2ì´ˆì—ì„œ í•„ìì˜ ë…¸íŠ¸ë¶ ê¸°ì¤€ìœ¼ë¡œ 6ë°€ë¦¬ì´ˆë¡œ ì„±ëŠ¥ì´ ëŒ€í­ ì¢‹ì•„ì§€ê¸´í–ˆì§€ë§Œ, ìœ„ ë°©ì‹ë„ ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ì¡´ì¬í•œë‹¤.

ì²«ë²ˆì§¸ë¡œëŠ” ë©€í‹°ì“°ë ˆë”© í™˜ê²½ì—ì„œì˜ ê³µìœ  ë³€ìˆ˜ê´€ë ¨í•œ ë†’ì€ ì´í•´ë„ë¥¼ ê°œë°œìì—ê²Œ ìš”êµ¬í•œë‹¤.
ë‘ë²ˆì§¸ë¡œëŠ” ë°”ë¡œ ì½œë°± ì§€ì˜¥(Callback Hell)ë¡œ ë¹ ì§ˆ ìˆ˜ ìˆëŠ” ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤.

+ [ì°¸ê³  : Callback hell](http://callbackhell.com/)

ê·¸ë ‡ë‹¤ë©´, ë¹„ë™ê¸°ì˜ ì¥ì ì„ ëˆ„ë¦¬ë©´ì„œ ìœ„ì˜ ë‹¨ì ì„ í•´ê²°í•  ìˆ˜ëŠ” ì—†ì„ê¹Œ? ì´ ë¶€ë¶„ì€ ìë°”ì˜ `Future`ë¥¼ í†µí•´ì„œ ì–´ëŠì •ë„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

#### STEP 2.2.1.3 Future ì‹œë‚˜ë¦¬ì˜¤

```java
public interface ShoppingCardService {  
	Future<Output> calculate(Input value);  
}

// FutureShoppingCardService.java
... (ì¤‘ëµ) ...
@Override  
public Future<Output> calculate(Input value) {  
	FutureTask<Output> future = new FutureTask<>(() -> {  
		Thread.sleep(1000);  
		return new Output();  
	}); 
	 
	new Thread(future).start();  
	return future;  
}
... (ì¤‘ëµ) ...

// OrderService.java
... (ì¤‘ëµ) ...
void process() {  
	Input input = new Input();  
	Future<Output> result = shoppingCardService.calculate(input);  
  
	System.out.println(shoppingCardService.getClass().getSimpleName() + " execution completed");  
  
	try {  
		result.get();  
	} catch (InterruptedException | ExecutionException e) {  
		e.printStackTrace();  
	}  
}
... (ì¤‘ëµ) ...

public static void main(String[] args) {  
	long start = System.currentTimeMillis();  
  
	OrdersService ordersService = new OrdersService(new FutureShoppingCardService());  
  
	ordersService.process();  
	ordersService.process();  
  
	System.out.println("Total elapsed time in millis is : " + (System.currentTimeMillis() - start));  
}
```

`Future`ëŠ” ë¦¬í„´ ê°’ì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ ë˜ëŠ” ê·¸ ë¦¬í„´ ê°’ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ë¸”ë¡í‚¹ì„ í•´ì•¼í•˜ëŠ” ì§€ ë“±ì„ íŒŒì•…í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤.
ìœ„ ì½”ë“œì—ì„œëŠ” ìƒëµí–ˆì§€ë§Œ, `return future;` ë¬¸ì´ ëë‚˜ê³  `OrdersService`ì—ì„œëŠ” `.get()` ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì‹¤ì œ ê°’ì„ ê°€ì ¸ì˜¤ê²Œë”í•œë‹¤. 
ì‹¤ì œ ë™ì‘í•˜ë©´ ëŒ€ëµ 2ì´ˆê°€ ê±¸ë¦¬ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ì´ëŠ” `.get()` ë©”ì„œë“œê°€ ê²°ê³¼ê°’ì„ ë°›ì„ë•Œê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ë¸”ë¡í‚¹ ë©”ì„œë“œì´ê¸° ë•Œë¬¸ì´ë‹¤.
`.isDone()` ë©”ì„œë“œê°™ì€ ê²ƒì„ í™œìš©í•˜ë©´ ì¦‰ì‹œ ë°˜í™˜í•  ìˆ˜ë„ ìˆë‹¤.

`Future`ë¥¼ í†µí•´ì„œ ì½œë°± ì§€ì˜¥ì´ë¼ëŠ” ë¬¸ì œì ê³¼ ë©€í‹° ì“°ë ˆë”©ì˜ ë³µì¡ì„±ì„ ê°œë°œìê°€ ëª°ë¼ë„ ë˜ê²Œë” ì²˜ë¦¬ëœ ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.
ê·¸ëŸ¬ë‚˜, ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•´ì„œ í˜„ì¬ ì“°ë ˆë“œë¥¼ ë¸”ë¡(`.get()`) í•˜ê³  ë™ê¸°í™”í•´ì•¼ë˜ëŠ” ë¶ˆí¸í•¨ì´ ì¡´ì¬í•˜ì—¬ í™•ì¥ì„±ì´ ê°ì†Œëœë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë•Œë¬¸ì— Java 8ë¶€í„°ëŠ” `CompletableFuture`ì™€ ê°™ì€ `CompletionStage`[^5]ë¥¼ ì œê³µí•˜ê¸° ì‹œì‘í–ˆë‹¤.

#### STEP 2.2.1.4 CompletableFuture ì‹œë‚˜ë¦¬ì˜¤

```java
public interface ShoppingCardService {  
	CompletableFuture<Output> calculate(Input input);  
}

... (ì¤‘ëµ) ...
@Override  
public CompletableFuture<Output> calculate(Input input) {  
	return CompletableFuture.supplyAsync(() -> {  
		try {  
			Thread.sleep(1000);  
		} catch (InterruptedException e) {  
			e.printStackTrace();  
		}  
		return new Output();  
	});  
}
... (ì¤‘ëµ) ...

... (ì¤‘ëµ) ...
void process() {  
	Input input = new Input();  
  
	shoppingCardService.calculate(input)  
			.thenAccept(v -> System.out.println(shoppingCardService.getClass().getSimpleName() + " execution completed"));  
  
	System.out.println(shoppingCardService.getClass().getSimpleName() + " calculate called");  
}
... (ì¤‘ëµ) ...

public static void main(String[] args) throws InterruptedException {  
	long start = System.currentTimeMillis();  
  
	OrdersService ordersService = new OrdersService(new CompletableFutureShoppingCardService());  
  
	ordersService.process();  
	ordersService.process();  
  
	System.out.println("Total elapsed time in millis is : " + (System.currentTimeMillis() - start));  
  
	Thread.sleep(1000);  
}
```

`CompletableFuture`ì˜ ì¥ì ì€ ìˆ˜í–‰ í›„ `thenAccept()` ë‚˜ `thenCombine()` ë©”ì„œë“œì™€ ê°™ì€ ë©”ì„œë“œë“¤ê³¼ ì²´ì´ë‹ì„ ì´ë£° ìˆ˜ ìˆê³ , ìë°”8 ì´í›„ì— ë‚˜ì˜¨ ëŒë‹¤í‘œí˜„ì‹ê³¼ë„ ì°°ë–¡ê¶í•©ì²˜ëŸ¼ ì“°ì¼ ìˆ˜ ìˆë‹¤. ë˜í•œ, `Future`ì™€ ë‹¤ë¥´ê²Œ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ê²°ê³¼ê°€ ì‹¤ì œ ì‚¬ìš©ê°€ëŠ¥í•  ë•Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë„ ì œê³µí•œë‹¤.  í•˜ì§€ë§Œ, ìŠ¤í”„ë§ ì§„ì˜ì—ì„œëŠ” í•˜ìœ„í˜¸í™˜ì„±ì„ ìœ„í•´ì„œ `CompletionStage` ë¥¼ ì§€ì›í•˜ì§€ ì•Šê³ , `ListenableFuture`[^6]ë¥¼ ì œê³µí•˜ì˜€ë‹¤.

ê·¸ì— ëŒ€í‘œì ì¸ ë…€ì„ì´ `AsyncRestTemplate`[^6] ì´ë‹¤.  ì´ í´ë˜ìŠ¤ëŠ” ë¹„ë™ê¸° í˜¸ì¶œì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë‹¤ì‹œ ì½œë°±ì„ ì‚¬ìš©í•˜ì˜€ê³ , ë‚´ë¶€ì ìœ¼ë¡œ ë³„ë„ ì“°ë ˆë“œì—ì„œ ë¸”ë¡í‚¹í•˜ëŠ” ì‘ì—… ë“±ì´ ì¡´ì¬í•˜ì˜€ë‹¤. ë˜í•œ, Spring MVCëŠ” Servlet APIì— ì˜ì¡´ì ìœ¼ë¡œ ë™ì‘í•˜ì—¬ ëª¨ë“  êµ¬í˜„ì— ì“°ë ˆë“œ ë‹¹ ìš”ì²­(Request per Thread)[^7] ì„ ì˜ë¬´í™”í•˜ì˜€ë‹¤. 

ì´ëŸ¬í•œ ë¬¸ì œëŠ” SpringFramework 5ì˜ `WebClient`[^8] ì˜ ë„ì…ìœ¼ë¡œ í•´ì†Œê°€ ë˜ëŠ” ë“¯í•˜ì˜€ë‹¤. ì´ë¥¼ í†µí•´ì„œ ë…¼ë¸”ë¡í‚¹ í†µì‹ ì„ ì¶©ë¶„íˆ ê°€ëŠ¥ì¼€ í•˜ì˜€ê³ , Servlet ë˜í•œ, 3ì—ì„œëŠ” ë¹„ë™ê¸° í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜[^9]ì„ ì§€ì›í•˜ê³  3.1ì—ì„œëŠ” ë…¼ë¸”ë¡í‚¹ ì“°ê¸° ì‘ì—…[^9]ì„ ì§€ì›í•˜ì˜€ë‹¤.
ì´ë¡œì¨, ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ëª¨ë“  ê³¼ì •ì—ì„œ ë…¼ë¸”ë¡í‚¹í•œ ì‘ì—…ì´ ê°€ëŠ¥í•´ì¡Œë‹¤.

í•˜ì§€ë§Œ 3.1ì—ì„œ ì§€ì›í•˜ëŠ” APIëŠ” Spring MVCì™€ ê¶í•©ì´ ë§ì§€ ì•Šì•˜ëŠ”ë°, ë™ê¸°ì‹(`Filter`, `Servlet`) ë‚˜ ë¸”ë¡í‚¹( `getParameter, getPart`) ì‘ì—… ë“±ì´ ì¡´ì¬í•˜ì˜€ê¸° ë•Œë¬¸ì— ë…¼ë¸”ë¡í‚¹ I/Oë¥¼ ì§€ì›í•˜ë ¤ë©´ ë‚˜ë¨¸ì§€ APIë“¤ì´ ë¬¸ì œê°€ ìƒê²¼ë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ë§ì€ ë¶€ë¶„ì„ ìˆ˜ì •í•´ì•¼ëì—ˆëŠ”ë° í•˜ë‚˜ê°™ì´ ì „ë¶€ ì–´ë ¤ìš´ ë¬¸ì œë“¤ì´ì—ˆë‹¤. ë˜í•œ, JVMì˜ ì“°ë ˆë“œ ë‹¹ ì¼ë°˜ì ì¸ í¬ê¸°ëŠ” 1,024KBì¸ë° 64,000ê°œì˜ ë™ì‹œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ëŠ” ìƒí™©ì´ë©´ ëŒ€ëµì ìœ¼ë¡œ 64GBì˜ ë©”ëª¨ë¦¬ê°€ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì œí•œëœ ìˆ˜ë¡œ ì“°ë ˆë“œ í’€ë¡œ ì„¤ì •í•  ê²½ìš°ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ ì‘ë‹µì´ ì§€ì—°ì´ ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤.

ë”êµ°ë‹¤ë‚˜ ë¦¬ì•¡í‹°ë¸Œ ì„ ì–¸ë¬¸ì—ì„œ ë…¼ë¸”ë¡í‚¹ ì—°ì‚°ì„ ê¶Œì¥í•˜ê³  ìˆëŠ”ë° ì´ëŠ” ìŠ¤í”„ë§ ìƒíƒœê³„ì—ì„œëŠ” ì–´ì°Œë³´ë©´ ëˆ„ë½ì´ ë˜ì—ˆë‹¤. ì¶”ê°€ë¡œ ì´ë•Œê¹Œì§€ë§Œ í•´ë„ ìŠ¤í”„ë§ì€ ë°˜ì‘í˜• ì„œë²„ì¸ Nettyê°™ì€ ê²ƒê³¼ í†µí•©ì´ ì˜ ë˜ì–´ìˆì§€ê°€ ì•Šì•˜ë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ìŠ¤í”„ë§ ì§„ì˜ì—ì„œëŠ” **ë°˜ì‘í˜• í”„ë¡œê·¸ë˜ë°**ì„ êº¼ë‚´ë“¤ì—ˆê³ , ë°˜ì‘í˜• ì„œë²„ì™€ í†µí•©ì„ ì‹œë„í•˜ì˜€ë‹¤. 
ê·¸ê²ƒì´ ë°”ë¡œ `Spring WebFlux`ì´ë‹¤. 

í•˜ì§€ë§Œ, ì´ í¬ìŠ¤íŒ…ì˜ ì¤‘ì ì€ `Spring WebFlux`ê°€ êµ¬í˜„í•œ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ(Reactive Streams)ì— ì´ˆì ì´ ë§ì¶°ì ¸ìˆì–´ì„œ ê·¸ ë¶€ë¶„ì— ëŒ€í•´ì„œ ì¢€ ë” ë‹¤ë£¨ê³ ìí•œë‹¤.

ìœ„ì— ë‚´ìš©ì€ ìë°” ê°œë°œìê°€ ì¹œìˆ™í•œ ìŠ¤í”„ë§ ì›¹í”ŒëŸ­ìŠ¤ì˜ ì¶œë²” ì´ìœ ì— ëŒ€í•´ì„œ ë‹¤ë¤˜ë‹¤ê³  ë³´ë©´ë  ê²ƒ ê°™ë‹¤.
ê²°êµ­, `Spring WebFlux`ë„ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ êµ¬í˜„ì²´ê¸° ë•Œë¬¸ì— ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ê³¼ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì— ëŒ€í•´ ì´í•´ë¥¼ í•˜ë©´ ì¢€ ë” ì ‘ê·¼ì´ ì‰¬ìš¸ ê²ƒì´ë‹¤. 

ì ì´ì œ, ì™œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì´ ëŒ€ë‘ê°€ ë˜ê²Œ ë˜ì—ˆëŠ”ì§€ ì•Œê²Œë˜ì—ˆë‹¤. ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ íŠ¹ì§•ì„ ì•Œì•„ë³´ì.

### STEP 2.2.2 ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ íŠ¹ì§• 

ìœ„ì—ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ ì •ì˜ì— ëŒ€í•´ì„œ ì•„ë˜ì™€ ê°™ì´ ì„¤ëª…í–ˆì—ˆë‹¤.

> ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë° í•„ìš”í•œ í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì´ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì´ë‹¤. 
> - ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, í™©ì •ì‹ ì €, p.30 -

ìì„¸í•œ ì •ì˜ëŠ” [ìœ„í‚¤í”¼ë””ì•„](https://en.wikipedia.org/wiki/Reactive_programming)ì— ì•„ë˜ì™€ ê°™ì´ ì •ì˜ë˜ì–´ìˆì—ˆë‹¤.

> InÂ [computing](https://en.wikipedia.org/wiki/Computing "Computing"),Â **reactive programming**Â is aÂ [declarative](https://en.wikipedia.org/wiki/Declarative_programming "Declarative programming")Â [programming paradigm](https://en.wikipedia.org/wiki/Programming_paradigm "Programming paradigm")Â concerned withÂ [data streams](https://en.wikipedia.org/wiki/Stream_(computing) "Stream (computing)")Â and the propagation of change.

ì—¬ê¸°ì„œ 2ê°€ì§€ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ë° 
1. ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì¦ˆì™€ ë³€í™”ì˜ ì „íŒŒ(Data Streams and the propagation of change)
2. ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„(Declarative Programming Paradigm)

1ë²ˆì— ëŒ€í•´ì„œ ì„¤ëª…í•˜ìë©´ ë°ì´í„° ìŠ¤íŠ¸ë¦¼(Data Stream)ì€ ë°ì´í„°ê°€ ì§€ì†ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” íë¦„ì„ ëœ»í•œë‹¤.
ë³€í™”ì˜ ì „íŒŒ(Propagation of Change)ëŠ” ì§€ì†ì ìœ¼ë¡œ ë°ì´í„°ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ì´ê²ƒì„ ë³€í™”í•˜ëŠ” ì´ë²¤íŠ¸ë¡œ ë³´ê³ , ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ë©´ì„œ ë°ì´í„°ë¥¼ ê³„ì†ì ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ì´ ë¶€ë¶„ì€ ì´ì „ì— ë‹¤ë¤˜ë˜ [ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ í†ºì•„ë³´ê¸°](https://brewagebear.github.io/overview-streaming-system/)ì— ì´ë²¤íŠ¸ ì£¼ë„ ì•„í‚¤í…ì²˜ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ì‘ì„±ëœ ë¶€ë¶„ì„ ë³´ë©´ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ê·¸ë ‡ë‹¤ë©´, ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ì€ ë¬´ì—‡ì¼ê¹Œ? ì´ëŠ” ì½”ë“œë¡œ ë³´ì—¬ì£¼ê³ ì í•œë‹¤.

#### STEP 2.2.2.1 ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ vs ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ 

ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë° íŒ¨ëŸ¬ë‹¤ì„ì€ ê¸°ì¡´ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ë˜ ì½”ë“œë¼ ë³´ë©´ ë  ê²ƒì´ë‹¤.  
1ë¶€í„° 100ê¹Œì§€ ìˆ«ì ì¤‘ì—ì„œ ì§ìˆ˜ í•©ì„ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì§œë³¸ë‹¤í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì§¤ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

```java
public static void main(String[] args) {
	int sum = 0;
	
	for(int i = 1; i <= 100; i++) {
		if(i % 2 == 0) {
			sum += i;
		}
	}
	
	System.out.println(sum); // 2550
}
```

ì´ëŸ¬í•œ ë°©ì‹ì´ ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì€ ì–´ë–¤ì‹ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì¼ê¹Œ? 

```java
public static void main(String[] args) {

	int sum = IntStream.rangeClosed(1, 100)  
						.filter(number -> number % 2 == 0)
						.reduce(0, Integer::sum);
	
	System.out.println(sum); // 2550
}
```

ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì€ ì•„ë‹ˆì§€ë§Œ, ìš°ë¦¬ê°€ ìì£¼ ì‚¬ìš©í•˜ëŠ” ìë°” ìŠ¤íŠ¸ë¦¼ ë˜í•œ ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì´ë‹¤. 

ê°€ì¥ í° ì°¨ì´ë¥¼ ë³´ì´ëŠ” ë¶€ë¶„ì€ `for`ë¬¸ê³¼  `if`ë¬¸ì˜  ì¡´ì¬ìœ ë¬´ì¼ ê²ƒì´ë‹¤. 

ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ì€ `for`ì™€ `if`ë¥¼ í†µí•´ì„œ "1 ~ 100 ì§ìˆ˜ í•©"ì´ë¼ëŠ” ê²°ë¡ ì„ ë„ì¶œí•˜ê¸° ìœ„í•´ì„œ ì»´í“¨í„°ê°€ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì„ ì„¤ëª…í•˜ëŠ” ì‹ìœ¼ë¡œ ì‘ì„±ë˜ì–´ì™”ë‹¤. 
ê·¸ëŸ¬ë‚˜, ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì€ `rangeClosed()`, `filter()`, `reduce()` ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì§€ì •í•œë‹¤ëŠ” ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤ëŠ” ì ì´ë‹¤. 

ì´ë¥¼ ë³´ì™„í•˜ë©´ `rangeClosed()`ì—ëŠ” ë‚´ê°€ ì›í•˜ëŠ” ìˆ«ìì˜ ë°”ìš´ë”ë¦¬ë¥¼ ì§€ì •í•˜ê³ , `filter()` ë©”ì„œë“œë¥¼ í†µí•´ì„œ `number % 2 ==0`ì¸ ê²°ê³¼ë¥¼ í•„í„°ë§í•˜ê³ , `reduce()` ë©”ì„œë“œë¥¼ í†µí•´ ì‹¤ì œë¡œ ê°’ì„ ë”í•œë‹¤.
ì´ê²ƒì´ ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ê³¼ ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì˜ ì°¨ì´ì´ë‹¤. 

ì˜ ì´í•´ê°€ ì•ˆê°„ë‹¤ë©´ ì•„ë˜ì˜ ê¸€ì„ ì°¸ê³ í•˜ì.
+ [Imperative vs Declarative Programming in JavaScript](https://www.linkedin.com/pulse/imperative-vs-declarative-programming-javascript-yehuda-margolis/)

ì¶”ê°€ì ìœ¼ë¡œ ë©”ì„œë“œ ì²´ì´ë‹(`rangeClosed(..).filter(..).reduce(..)`) ê³¼ ê°™ì´ **ì½”ë“œê°€ ê°„ê²°í•´ì§€ê³  ê°€ë…ì„±ë„ ë†’ì•„ì§„ë‹¤ëŠ” ì¥ì **ë„ ìˆë‹¤.

>  ğŸ’¡ ì´ ë¶€ë¶„ì€ ë‹¤ì†Œ ì˜¤í•´ì˜ ì†Œì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ë°, ì½”ë“œ ìì²´ë¥¼ **ì‰½ê²Œ ì´í•´í•˜ëŠ” ê²ƒ**ì€ `for`ë¬¸ì´ ë” ë‚˜ì„ ìˆ˜ ìˆë‹¤.
>  ê·¸ë¦¬ê³  ë©”ì„œë“œ ì²´ì´ë‹ì˜ ê¸¸ì´ê°€ ê¸¸ì–´ì§ˆìˆ˜ë¡ ì˜¤íˆë ¤ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ëŠ” ìƒí™©ë„ ìˆìœ¼ë¯€ë¡œ ëŒ€í•œ ì»¨ë²¤ì…˜ì„ ì ì ˆí•˜ê²Œ ì •í•œ í›„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì˜¬ë°”ë¥´ë‹¤ ìƒê°í•œë‹¤.
>  
>  ì˜ˆë¥¼ ë“¤ì–´, ë³µì¡í•œ ë„ë©”ì¸ ë¡œì§ì¸ ê²½ìš°ì—ëŠ” ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì„ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•  ê²½ìš° ì˜¤íˆë ¤ ë™ë£Œê°€ ì´í•´ë¥¼ ëª»í•  ìˆ˜ ìˆìœ¼ë‹ˆ ëª¨ë‘ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ì‘ì„±ì„ í•˜ê³ ,  ë‹¨ìˆœ ë¡œì§ì¸ë° ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ì„ ì“°ë©´ ì§€ì €ë¶„í•´ì§€ëŠ”ë° ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì„ ì‚¬ìš©í•˜ë©´ 3ì¤„ ì´ë‚´ë¡œ ëë‚˜ëŠ” ì¼€ì´ìŠ¤ëŠ” í›„ìê°€ ë‚˜ì„ ìˆ˜ë„ ìˆë‹¤. ëª¨ë“  ê²ƒì€ íŠ¸ë ˆì´ë“œ-ì˜¤í”„ì´ë‹¤.

ë˜í•œ, `filter(number -> number % 2 == 0)` ì™€ ê°™ì´ ëŒë‹¤ì™€ ê°™ì€ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ êµ¬ì„±ëœë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤. 

ì •ë¦¬ë¥¼ í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

1. ì„ ì–¸í˜• í”„ë¡œê·¸ë˜ë°ì€ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì§€ì •í•˜ëŠ”ë° ì¤‘ì ì„ ì£¼ëŠ” íŒ¨ëŸ¬ë‹¤ì„ì´ë‹¤.
2. ë©”ì„œë“œ ì²´ì´ë‹ì„ í†µí•´ì„œ ì½”ë“œê°€ ê°„ê²°í•´ì§€ê³  ê°€ë…ì„±ì´ ë†’ì•„ì§„ë‹¤. 
3. ëŒë‹¤ì™€ ê°™ì€ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì„ í†µí•´ì„œ ì¥ì ì„ ê·¹ëŒ€í™” ì‹œí‚¨ë‹¤.


### STEP 2.2.3 ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ êµ¬ì„± 

ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ êµ¬ì„± ìš”ì†ŒëŠ” í¬ê²Œ ì•„ë˜ì˜ 4ê°€ì§€ì™€ ê°™ë‹¤.

| êµ¬ì„±ìš”ì†Œ    | ì„¤ëª…                                                                                              | 
| ----------- | ------------------------------------------------------------------------------------------------- |
| Publisher   | ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ì—­í•                                                           |    
| Subscriber  | Publisherê°€ ì œê³µí•œ ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì£¼ì²´                                              |     
| Data Source | Publisherì˜ ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ì›ì²œ ë°ì´í„°(ì—„ë°€íˆ ë”°ì§€ë©´ ë‹¤ë¥´ê¸´í•œë° Data Streamì´ë¼ í‘œê¸°í•˜ê¸°ë„ í•¨) |     
| Operator    | ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ Publisher <-> Subscriber ì‚¬ì´ì—ì„œ ê°€ê³µì²˜ë¦¬ë¥¼ í•˜ëŠ” ì—­í•                             |     

ê·¸ë ‡ê²Œ ì–´ë ¤ìš´ ë‚´ìš©ì€ ì•„ë‹ˆë‹ˆ ìœ„ì˜ í‘œë¡œ ì„¤ëª…ì´ ê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•œë‹¤.

ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ êµ¬ì„± ìš”ì†Œê°€ í•„ìš”í•œë‹¤ ì •ë„ë§Œ ìˆì—ˆê³  ì´ë¥¼ êµ¬í˜„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‚˜ ìƒíƒœê³„ëŠ” ë¶€ì¡±í–ˆë˜ ìƒí™©ì´ì—ˆë‹¤. 
2007ë…„ì— MSì—ì„œëŠ” Rx ë¼ì´ë¸ŒëŸ¬ë¦¬[^10]ë¥¼ ì„¸ìƒì— ë‚´ë†“ì•˜ê³ , ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì¸ê¸°ë¥¼ ì–»ê¸° ì‹œì‘í•˜ì˜€ë‹¤. 

ì´ëŸ¬í•œ ì¸ê¸° ë•ì— MSì—ì„œëŠ” Rx.NETì„ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ê³µê°œí•˜ì˜€ê³ , Rxê°€ ê°€ì§„ ì•„ì´ë””ì–´ëŠ” MSë¿ë§Œ ì•„ë‹ˆë¼ ì „ì„¸ê³„ë¡œ í¼ì§€ê²Œ ë˜ì—ˆë‹¤.
ë„·í”Œë¦­ìŠ¤ëŠ” ì´ëŸ¬í•œ Rx.NETì„ RxJava[^11]ë¡œ í¬íŒ…ì„ í•˜ì˜€ê³  2013ë…„ì— ì˜¤í”ˆì†ŒìŠ¤ë¡œ ê³µê°œë¥¼ í•˜ì˜€ë‹¤.

ì´ëŸ¬í•œ ì˜í–¥ì„ ë°›ì•„ì„œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ ìˆ˜ìš”ê°€ ì¦ê°€í•˜ë©´ì„œ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì´ ë‚˜ì˜¤ê²Œ ë˜ì—ˆë‹¤. 
ë°˜ì‘í˜• ì„œë²„ì¸ Vert.x[^12]ëŠ” ì´ˆê¸°ì— ì½œë°± ê¸°ë°˜ í†µì‹ ë§Œ ì§€ì›í–ˆì§€ë§Œ, ì´í›„ì—ëŠ” ìì²´ ì†”ë£¨ì…˜ì„ ë§Œë“¤ì–´ì„œ RxJavaì˜ ì•„ì´ë””ì–´ë¥¼ ì°¨ìš©í•˜ì˜€ë‹¤.
+ ì°¸ê³  : https://vertx.io/docs/vertx-reactive-streams/java/

ì´ë ‡ê²Œ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë° ìƒíƒœê³„ê°€ í’ì„±í•´ì§€ê³  ìˆì—ˆì§€ë§Œ ìë°” ì§„ì˜ì—ì„œëŠ” ëª‡ ê°€ì§€ ë¬¸ì œì ì´ ì¡´ì¬í•˜ì˜€ë‹¤. ë‹¤ì–‘í•œ ë¦¬ì•¡í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ê³ ì í•˜ë©´ ì¶©ëŒì´ ë°œìƒí•˜ê±°ë‚˜ ì˜ˆê¸°ì¹˜ ì•ŠëŠ” ë™ì‘ì´ ë°œìƒí•˜ëŠ” ë“± ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ë‹¤. (ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì€ ìœ ê¸°ì ìœ¼ë¡œ í˜ëŸ¬ì•¼í•˜ëŠ”ë° ì„œë¡œ êµ¬í˜„í•œ ë°©ì‹ì´ ë‹¤ë¥´ë‹¤ë³´ë‹ˆ ë¬¸ì œê°€ ë°œìƒ)

ì´ì— í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•„ìš”ì„±ì— ëŒ€í•´ì„œ ì´ì•¼ê¸°ê°€ ë˜ê¸° ì‹œì‘í•˜ì˜€ê³ , Netlixì™€ Pivotal, Lightbendì˜ ì—”ì§€ë‹ˆì–´ë“¤ì´ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆë¼ëŠ” í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°œë°œí•˜ì˜€ë‹¤.

2015ë…„ 4ì›”ì— ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆê°€ ê³µì‹ ë¦´ë¦¬ì¦ˆ ë˜ì—ˆê³ , 2017ë…„ 9ì›”ì— ì´ í‘œì¤€ì˜ ì‚¬ìš© ì›ì¹™ì„ ê·¸ëŒ€ë¡œ í¬íŒ…í•œ ê²ƒì´ ë°”ë¡œ [Flow API](https://docs.oracle.com/javase/9/docs/api/java/util/concurrent/Flow.html)ì´ë‹¤.
ì´ë¡œì¨ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆê°€ ìë°”ì˜ ê³µì‹ ê¸°ëŠ¥ì´ ë˜ì—ˆë‹¤.

## STEP 2.3 ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ 

ìœ„ì—ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ê³¼ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆê°€ ì™œ ëŒ€ë‘ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ì„œ ì„¤ëª…í•˜ì˜€ë‹¤. 
í•œë§ˆë””ë¡œ ì •ì˜í•˜ë©´ ì•„ë˜ì™€ ê°™ì„ ê²ƒì´ë‹¤.

> ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì„ Non-Blockingì´ë©´ì„œ ë¹„ë™ê¸°ì ì¸ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë¦¬ì•¡í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í‘œì¤€ì‚¬ì–‘
> - ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, í™©ì •ì‹ ì €, p.39 -

ì§€ê¸ˆë¶€í„°ëŠ” ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì˜ êµ¬ì„±ìš”ì†Œì— ëŒ€í•´ì„œ ì„¤ëª…í•˜ê³ ì í•œë‹¤.


### STEP 2.3.1 ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ êµ¬ì„±ìš”ì†Œ 

êµ¬ì„±ìš”ì†ŒëŠ” ê±°ì˜ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ êµ¬ì„±ìš”ì†Œì—ì„œ ë´¤ë˜ ë‚´ìš©ê³¼ í¡ì‚¬í•˜ë‹¤.

| êµ¬ì„±ìš”ì†Œ    | ì„¤ëª…                                                                                              | 
| ----------- | ------------------------------------------------------------------------------------------------- |
| Publisher   | ë°ì´í„°ë¥¼ ìƒì„± í›„ ë°©ì¶œ(Emit)í•˜ëŠ” ì—­í•                                                           |    
| Subscriber  | êµ¬ë…í•œ Publisherë¡œ ë¶€í„° ë°©ì¶œëœ ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ì•„ ì²˜ë¦¬í•˜ëŠ” ì—­í•                                               |     
| Subscription | Publisherì— ìš”ì²­í•  ë°ì´í„°ì˜ ê°œìˆ˜ë¥¼ ì§€ì •í•˜ê³ , êµ¬ë…ì„ ì·¨ì†Œí•˜ëŠ” ì—­í•  |     
| Processor    | Publisherì™€ Subscriberì˜ ê¸°ëŠ¥ì„ ëª¨ë‘ ê°–ê³  ìˆëŠ” êµ¬ì„±ìš”ì†Œ                           |     

êµ¬ì„±ìš”ì†Œê°„ íë¦„ì„ ì•Œê¸° ìœ„í•´ì„œ ê°„ë‹¨í•œ ì½”ë“œë¥¼ ê°€ì ¸ì™”ë‹¤.

```java
public static void main(String[] args) throws InterruptedException {  
	Flux<String> flux = Flux.just("Hello", "World")  
							.log();  
  
	flux.subscribe(log::info,  
					error -> log.error(error.getMessage()),  
					() -> log.info("complete"));  
  
	Thread.sleep(1000L);  
}
```

ì—¬ê¸°ì„œ `Flux`ê°€ ë¬´ì—‡ì´ê³ , `subscribe()` ë©”ì„œë“œê°€ ë¬´ì—‡ì¸ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤. 
í•´ë‹¹ ì½”ë“œë¥¼ ë™ì‘í•œ í›„ ë¡œê·¸ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¨ë‹¤.

```sh
14:13:08.483 [main] INFO reactor.Flux.Array.1 -- | onSubscribe([Synchronous Fuseable] FluxArray.ArraySubscription)
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | request(unbounded)
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | onNext(Hello)
14:13:08.485 [main] INFO reactive.Example1 -- Hello
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | onNext(World)
14:13:08.485 [main] INFO reactive.Example1 -- World
14:13:08.486 [main] INFO reactor.Flux.Array.1 -- | onComplete()
14:13:08.486 [main] INFO reactive.Example1 -- complete
```

ì–´ë–¤ì‹ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì¼ê¹Œ? `Processor`ë¥¼ ì œì™¸í•œ 3ê°€ì§€ êµ¬ì„±ìš”ì†Œì˜ ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œë¥¼ í™•ì¸í•´ë³´ì.

```java
public interface Publisher<T> {
   public void subscribe(Subscriber<? super T> s);
}
 
public interface Subscriber<T> {
   public void onSubscribe(Subscription s);
   public void onNext(T t);
   public void onError(Throwable t);
   public void onComplete();
}
 
public interface Subscription {
   public void request(long n);
   public void cancel();
}
```

ìœ„ ì½”ë“œì™€ í•¨ê»˜ ë¡œê·¸ì˜ íë¦„ì„ ê°™ì´ ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ íë¦„ìœ¼ë¡œ í”Œë¡œìš°ê°€ í˜ëŸ¬ê°„ë‹¤.

1. `Publisher.subscribe()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `Subscriber`ë¥¼ ë“±ë¡í•œë‹¤.
2. `Subscriber.onSubscribe()` ë©”ì„œë“œë¥¼ í†µí•´ `Subscription`ì„ `Publisher`ì— ì „ë‹¬í•˜ë©°, ì´ ê³¼ì •ì—ì„œ `request()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì ¸ì˜¬ ë°ì´í„°ì˜ ê°œìˆ˜ë¥¼ ê²°ì •í•œë‹¤.
3. `Publisher`ëŠ” `request()` ë©”ì„œë“œì—ì„œ ì§€ì •í•œ ê°œìˆ˜ë§Œí¼ ë°ì´í„°ë¥¼ `Subscriber`ì—ê²Œ ë°©ì¶œí•œë‹¤. ì´ë•Œ, ë°ì´í„° ë°©ì¶œì—ëŠ” `onNext()` ë©”ì„œë“œê°€ ì‚¬ìš©ëœë‹¤.
4. ë°ì´í„° ë°©ì¶œì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ë©´ `onComplete()` ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©°, ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° `onError()` ë©”ì„œë“œê°€ ì‹¤í–‰ëœë‹¤.

ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

<p align="center">
    <img src="https://i.imgur.com/3cD1Zk4.png">
</p>
<p align="center">
    <em><a href="https://engineering.linecorp.com/ko/blog/reactive-streams-with-armeria-1"> ê·¸ë¦¼ 5. ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ êµ¬ì„±ìš”ì†Œê°„ ì—°ê´€ê´€ê³„( Armeriaë¡œ Reactive Streamsì™€ ë†€ì!-1, lkhun Um, 2020)</a></em>
</p>

ì´ì œ ë‹¤ì‹œ ë¡œê·¸ì™€ ì½”ë“œë¥¼ ë³´ê¸°ë°”ë€ë‹¤. 

ì½”ë“œì—ì„œ `Flux`ëŠ” `Publisher`ë¡œ ê°„ì£¼ë  ìˆ˜ ìˆë‹¤.  ê·¸ë¦¬ê³  `Subscriber`ëŠ” ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. 
`request()` ë©”ì„œë“œì— ëŒ€í•œ ë³„ë„ì˜ ì²˜ë¦¬ê°€ ì—†ì—ˆê¸° ë•Œë¬¸ì— "unbounded" ìš”ì²­ì´ ë°œìƒí–ˆë‹¤. ì´ê²ƒì€ ë¬´í•œ ìŠ¤íŠ¸ë¦¼ì„ ì˜ë¯¸í•œë‹¤. 

ë”°ë¼ì„œ `Flux`ì— í¬í•¨ëœ "Hello"ì™€ "World"ë¼ëŠ” ë‘ ê°œì˜ ë°ì´í„°ê°€ ìˆœì°¨ì ìœ¼ë¡œ ë°©ì¶œë  ê²ƒì´ë‹¤. 
ê° ë°ì´í„°ê°€ ë°©ì¶œë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ `OnNext()` ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤. ê·¸ë¦¬ê³  ì—ëŸ¬ ì—†ì´ ëª¨ë“  ë°ì´í„°ê°€ ë°©ì¶œë˜ë©´ ì—¬ê¸°ì„œ ì„¸ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ "complete"ê°€ ì¶œë ¥ëœë‹¤.

```java
flux.subscribe(log::info,  
               error -> log.error(error.getMessage()), // error
               () -> log.info("complete"));  // complete
```

## STEP 3. Project Reactor 

ìœ„ì—ì„œëŠ” ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì˜ êµ¬ì„±ìš”ì†Œì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤. ì´ì œ ì´ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì˜ êµ¬í˜„ì²´ ì¤‘ì— í•˜ë‚˜ì¸ Project Reactor[^2]ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤. ReactorëŠ” ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ íŒ€ ì£¼ë„í•˜ì— ê°œë°œëœ êµ¬í˜„ì²´ì´ë‹¤. ì‹¤ì œ WebFluxì˜ ì½”ì–´ëŠ” ì´ Reactorê°€ ë‹´ë‹¹í•œë‹¤.

ì•„ë˜ì˜ ì½”ë“œë¥¼ ë‹¤ì‹œë´ë³´ì.

```java
public static void main(String[] args) throws InterruptedException {  
	Flux<String> flux = Flux.just("Hello", "World")  
							.map(String::toUpperCase)  
							.log();  
  
	flux.subscribe(log::info,  
					error -> log.error(error.getMessage()),  
					() -> log.info("complete"));  
  
	Thread.sleep(1000L);
}
```

ë¦¬ì•¡í„°ì—ì„œëŠ” `Publisher`ë¥¼ í¬ê²Œ 2ê°€ì§€ë¥¼ ì œê³µí•œë‹¤.

1. `Flux` : 0ê°œë¶€í„° Nê°œì˜ ë°ì´í„°ë¥¼ ë°©ì¶œí•  ìˆ˜ ìˆëŠ” `Publisher`
2. `Mono` : 0ê°œë¶€í„° 1ê°œì˜ ë°ì´í„°ë¥¼ ë°©ì¶œí•  ìˆ˜ ìˆëŠ” `Publisher`

ìœ„ì˜ ì½”ë“œì—ì„œëŠ” `Flux.just(..)` ë©”ì„œë“œë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ "Hello" ì™€ "World"ê°€ **ë°ì´í„° ì†ŒìŠ¤(Data Source)** ë¼ ë³¼ ìˆ˜ ìˆë‹¤.  `Subscriber`ëŠ” `flux.subscribe(log::info)` ì´ ë¶€ë¶„ì˜ `log::info`ë¼ ë³´ë©´ëœë‹¤. ì´ë¥¼ ëŒë‹¤ë¡œ ë°”ê¾¸ë©´ `data -> log.info("{}", data)`
ì™€ ê°™ì€ ì½”ë“œë¼ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì´ ëŒë‹¤ í‘œí˜„ì‹ì€ `Consumer` í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ë¡œ `LambdaSubscriber`[^12]ë¼ëŠ” í´ë˜ìŠ¤ì— ì „ë‹¬ë˜ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤.

ê·¸ë¦¬ê³  `just()` ë‚˜ `map()` ê³¼ ê°™ì€ ë©”ì„œë“œë“¤ì„ `Operator`ë¼ê³  ë¶€ë¥´ë©° ì›ë³¸ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ì—­í• ì„ í•´ì£¼ëŠ” ë©”ì„œë“œë“¤ì´ë‹¤.

### STEP 3.1 Cold Sequence & Hot Sequence

ìœ„ì—ì„œëŠ” ê°„ë‹¨í•œ ë¦¬ì•¡í„° ì˜ˆì‹œë¥¼ í† ëŒ€ë¡œ ì„¤ëª…ì„ ì§„í–‰í–ˆì—ˆë‹¤.
ì´ì œ ë¦¬ì•¡í„°ì—ì„œ ì¤‘ìš”í•œ ê°œë…ë“¤ì„ ë‹¤ë£¨ê³ , ê¸€ì„ ë§ˆë¬´ë¦¬ í•˜ê³ ìí•œë‹¤. 

ë¨¼ì €, ì²«ë²ˆì§¸ë¡œëŠ” Cold Sequenceì™€ Hot Sequenceë‹¤. 
ì´ëŠ” êµ¬ë…ì— ëŒ€í•œ ì¤‘ìš”í•œ ê°œë…ì´ë‹¤.  í‘œë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

| ì¢…ë¥˜          | íŠ¹ì§•                                                                                                 |
| ------------- | ---------------------------------------------------------------------------------------------------- |
| Cold Sequence | êµ¬ë…í•  ë•Œë§ˆë‹¤ ë°ì´í„° íë¦„ì´ ì²˜ìŒë¶€í„° ì‹œì‘ë˜ëŠ” Sequence                                               |
| Hot Sequence  | êµ¬ë…ì´ ë°œìƒí•œ ì‹œì  ì´ì „ì— ë°©ì¶œëœ ë°ì´í„°ëŠ” ë°›ì§€ ëª»í•˜ê³  ì‹œì  ì´í›„ì— ë°©ì¶œëœ ë°ì´í„°ë¥¼ ì „ë‹¬ ë°›ëŠ” Sequence |

### STEP 3.1.1 Cold Sequence

ì´ì œ Cold Sequenceì— ëŒ€í•´ì„œ ì¢€ ë” ì•Œì•„ë³´ê³ ì í•œë‹¤. ì´ëŠ” ë§ˆë¸”ë‹¤ì´ì–´ê·¸ë¨ì„ ë³´ë©´ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆë‹¤. 

<p align="center">
    <img src="https://i.imgur.com/uHHmQbZ.png">
</p>
<p align="center">
    <em><a href="https://velog.io/@korea3611/%EB%A6%AC%EC%95%A1%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88Reactive-Streams%EB%9E%80"> ê·¸ë¦¼ 6. Cold Sequence(ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆë€?, korea3611, 2022) </a></em>
</p>

ìœ„ ê·¸ë¦¼ì„ ì°¸ê³ í•˜ë©´ êµ¬ë…ì´ ì–¸ì œ ë°œìƒí•˜ë“  ë°©ì¶œë˜ëŠ” ë°ì´í„°ëŠ” ë™ì¼í•˜ê²Œ ë°›ëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ê°€ ìˆë‹¤. ì´ê²ƒì„ ì½”ë“œë¡œ êµ¬í˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```java
public static void main(String[] args) throws InterruptedException {  
	Flux<String> coldSequence = Flux.just("a", "b", "c", "d", "e", "f", "g")  
									.map(String::toUpperCase);  
  
	Mono<String> coldSequence2 = Mono.just("HI!!")  
									.map(String::toUpperCase);  
  
	coldSequence.subscribe(log::info);  
	coldSequence2.subscribe(log::info);  
  
	Thread.sleep(1000L);  
  
	coldSequence.subscribe(log::info);  
	coldSequence2.subscribe(log::info);  
  
	Thread.sleep(100L);
}
```

`Flux` ì™€ `Mono`ëŠ” ëŒ€í‘œì ì¸ Cold Sequenceì´ë‹¤.  ìœ„ ì½”ë“œì— ëŒ€í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```sh
16:50:54.421 [main] INFO reactive.ColdSequnece -- A
16:50:54.422 [main] INFO reactive.ColdSequnece -- B
16:50:54.422 [main] INFO reactive.ColdSequnece -- C
16:50:54.422 [main] INFO reactive.ColdSequnece -- D
16:50:54.422 [main] INFO reactive.ColdSequnece -- E
16:50:54.422 [main] INFO reactive.ColdSequnece -- F
16:50:54.422 [main] INFO reactive.ColdSequnece -- G
16:50:54.423 [main] INFO reactive.ColdSequnece -- HI!!
16:50:55.429 [main] INFO reactive.ColdSequnece -- A
16:50:55.429 [main] INFO reactive.ColdSequnece -- B
16:50:55.429 [main] INFO reactive.ColdSequnece -- C
16:50:55.429 [main] INFO reactive.ColdSequnece -- D
16:50:55.429 [main] INFO reactive.ColdSequnece -- E
16:50:55.429 [main] INFO reactive.ColdSequnece -- F
16:50:55.429 [main] INFO reactive.ColdSequnece -- G
16:50:55.430 [main] INFO reactive.ColdSequnece -- HI!!
```

`Thread.sleep(1000L)`ì„ ê±¸ì–´ì„œ 1ì´ˆ ë’¤ì— ë‹¤ì‹œ êµ¬ë…í•˜ê²Œë” ìˆ˜í–‰í–ˆì§€ë§Œ ë™ì¼í•œ ë°ì´í„°ê°€ ë°©ì¶œë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### STEP 3.1.1 Hot Sequence

<p align="center">
    <img src="https://i.imgur.com/wbJAGsW.png">
</p>
<p align="center">
    <em><a href="https://velog.io/@korea3611/%EB%A6%AC%EC%95%A1%ED%8B%B0%EB%B8%8C-%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88Reactive-Streams%EB%9E%80"> ê·¸ë¦¼ 7. Hot Sequence(ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆë€?, korea3611, 2022) </a></em>
</p>

Hot SequenceëŠ” ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ êµ¬ë… ì‹œì ë§ˆë‹¤ ë°ì´í„°ê°€ ë‹¬ë¼ì§„ë‹¤. 
ì‹¤ì œë¡œ ê·¸ëŸ¬í•œì§€ í•œë²ˆ ì½”ë“œë¡œ í™•ì¸í•´ë³´ì.

```java
public static void main(String[] args) throws InterruptedException {  
	Flux<String> hotSequence = Flux.just("a", "b", "c", "d", "e")  
		.map(String::toUpperCase)  
		.delayElements(Duration.ofSeconds(1))  
		.publish()  
		.refCount(1);  
  
	hotSequence.subscribe(data -> log.info("# Subscribe-1 : {}", data));  
  
	Thread.sleep(2100L);  
  
	hotSequence.subscribe(data -> log.info("# Subscribe-2 : {}", data));  
  
	Thread.sleep(2100L);  
  
	hotSequence.subscribe(data -> log.info("# Subscribe-3 : {}", data));  
  
	Thread.sleep(1000L);  
}
```

ë¦¬ì•¡í„°ì—ì„œëŠ” Cold Sequenceë¥¼ Hot Sequenceë¥¼ ë³€ê²½í•´ì£¼ëŠ” ë‹¤ì–‘í•œ ë©”ì„œë“œë“¤ì„ ì œê³µí•´ì¤€ë‹¤. 

ìœ„ì—ì„œ ì˜ˆì‹œëŠ” `Flux`ë¥¼ ì‚¬ìš©í•˜ì˜€ëŠ”ë° `publish()` ë©”ì„œë“œëŠ” `ConnectableFlux<T>` ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì„œë“œë¡œ ì´ë¥¼ í†µí•´ì„œ Cold Sequenceì¸ `Flux`ë¥¼ Hot Sequenceë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤. `refCount`ëŠ” ìµœì†Œ `Subscriber`ì˜ ê°œìˆ˜ë¡œ 1ë¡œ ì„¤ì •í–ˆë‹¤. 

ìœ„ ì½”ë“œë¥¼ ë™ì‘í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.

```sh
17:00:57.252 [parallel-1] INFO reactive.HotSequence -- # Subscribe-1 : A
17:00:58.263 [parallel-2] INFO reactive.HotSequence -- # Subscribe-1 : B
17:00:59.266 [parallel-3] INFO reactive.HotSequence -- # Subscribe-1 : C
17:00:59.267 [parallel-3] INFO reactive.HotSequence -- # Subscribe-2 : C
17:01:00.273 [parallel-4] INFO reactive.HotSequence -- # Subscribe-1 : D
17:01:00.274 [parallel-4] INFO reactive.HotSequence -- # Subscribe-2 : D
17:01:01.279 [parallel-5] INFO reactive.HotSequence -- # Subscribe-1 : E
17:01:01.280 [parallel-5] INFO reactive.HotSequence -- # Subscribe-2 : E
17:01:01.280 [parallel-5] INFO reactive.HotSequence -- # Subscribe-3 : E
```

ê° êµ¬ë… ì‹œì ì— ë”°ë¼ì„œ ê°’ì´ ë‹¬ë¼ì§€ëŠ” ì ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ìœ„ì—ì„œëŠ” `Flux`ë¥¼ Hot Sequenceë¡œ ë³€í™˜í–ˆëŠ”ë° ë’¤ì—ì„œ ì‚´í´ë³¼ `Sinks`ëŠ” `Flux` ë‚˜ `Mono`ì™€ ë‹¤ë¥´ê²Œ Hot Sequenceê°€ ê¸°ë³¸ì¸ ë…€ì„ì´ë‹¤.

### STEP 3.2 Sinks

ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì˜ êµ¬ì„±ìš”ì†Œ ì¤‘ì—ì„œ `Processor`ë¼ëŠ” ë†ˆì´ ì¡´ì¬í•˜ì—¬, `Subscriber`ì™€ `Publisher`ì˜ ì—­í• ì„ ëª¨ë‘ í•  ìˆ˜ ìˆë‹¤í–ˆëŠ”ë° ìœ„ì—ì„œëŠ” ê·¸ ë‚´ìš©ì—ì„œëŠ” ë‹¤ë£¨ì§„ ì•Šì•˜ë‹¤. ë¬¼ë¡ , ë¦¬ì•¡í„°ì—ì„œë„ `Processor`ë¥¼ ì œê³µí–ˆì§€ë§Œ, í•´ë‹¹ ê¸°ëŠ¥ì„ ê°œì„ í•œ `Sinks`ê°€ ë‚˜ì™”ìœ¼ë‹ˆ ì´ë¡œ ëŒ€ì²´í•˜ì—¬ ì„¤ëª…í•˜ê³ ì í•œë‹¤.

ìš°ì„  ì–´ë–¤ ì¼ì„ í•˜ëŠ” ë…€ì„ì¼ê¹Œ? 

> SinksëŠ” ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆì˜ Signalì„ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ í‘¸ì‹œí•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ì´ë©° Flux ë˜ëŠ” Monoì˜ ì˜ë¯¸ ì²´ê³„ë¥¼ ê°€ì§„ë‹¤.
>  - ìŠ¤í”„ë§ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°, Kevin, p.188 -

ë¬´ìŠ¨ ì–˜ê¸°ì¸ì§€ ê°ì´ ì•ˆì¡íˆëŠ”ë° ì´ ë¶€ë¶„ì€ ìœ„ì—ì„œ ë³¸ ë¡œê·¸ë¥¼ ë³´ë©´ ë°”ë¡œ ì´í•´í•  ìˆ˜ ìˆë‹¤.

```sh
14:13:08.483 [main] INFO reactor.Flux.Array.1 -- | onSubscribe([Synchronous Fuseable] FluxArray.ArraySubscription)
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | request(unbounded)
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | onNext(Hello)
14:13:08.485 [main] INFO reactive.Example1 -- Hello
14:13:08.485 [main] INFO reactor.Flux.Array.1 -- | onNext(World)
14:13:08.485 [main] INFO reactive.Example1 -- World
14:13:08.486 [main] INFO reactor.Flux.Array.1 -- | onComplete()
14:13:08.486 [main] INFO reactive.Example1 -- complete
```

ì´ ë¡œê·¸ë¥¼ ë³´ë©´, ì–´ë–¤ ì½”ë“œì˜€ëŠ”ì§€ ê¸°ì–µì´ ë‚  ê²ƒì´ë‹¤. ê·¸ëŸ¬ë‚˜ ìƒê°í•´ë³´ë©´ ìš°ë¦¬ëŠ” `onSubscribe()` ë‚˜ `onNext()` ë©”ì„œë“œë¥¼ ì½”ë“œì—ì„œ ì§  ì ì€ ì—†ì—ˆë‹¤.
ë‚´ë¶€ì ìœ¼ë¡œ `Flux`ë‚˜ `Mono`ê°€ í•´ë‹¹ ì‹œê·¸ë„ì„ ì „ì†¡í–ˆê¸° ë•Œë¬¸ì´ë‹¤. 

ê·¸ëŸ¬ë‚˜, `Sinks`ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë¥¼ í”„ë¡œê·¸ë˜ë° ì½”ë“œë¥¼ í†µí•´ ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.  ê·¸ëŸ¬ë©´ ê¸°ì¡´ ë°©ì‹ê³¼ ì–´ë– í•œ ì°¨ì´ê°€ ìˆì—ˆì„ê¹Œ?

```java
public static void main(String[] args) throws InterruptedException {  
	int tasks = 6;  
  
	Flux.create((FluxSink<String> sink) -> {  
					IntStream.range(1, tasks)  
							.forEach(n -> sink.next(doTasks(n)));  
				})  
				.subscribeOn(Schedulers.parallel())  
					.doOnNext(taskNumber -> log.info("# create() : {}", taskNumber))  
				.publishOn(Schedulers.boundedElastic())  
					.map(result -> result + " success!!")  
					.doOnNext(taskNumber -> log.info("# map(): {}", taskNumber))  
				.publishOn(Schedulers.parallel())  
				.subscribe(result -> log.info("# onNext(): {}", result));  
  
	Thread.sleep(1000L);  
}  
  
private static String doTasks(int taskNumber) {  
	return "task" + taskNumber + " result";  
}
```

ì½”ë“œê°€ ë³µì¡í•´ë³´ì¼ ìˆ˜ ìˆì§€ë§Œ ìš°ë¦¬ê°€ í™•ì¸í•  ë‚´ìš©ì€ `subscribeOn()` , `publishOn()` , `doOnNext()` ì™€ ê°™ì€ ì‹œê·¸ë„ì„ í”„ë¡œê·¸ë˜ë° ì ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. `create()` ë©”ì„œë“œëŠ” ê·¸ëŸ¬í•œ ì‘ì—…ì„ ìœ„í•œ ëŒ€í‘œì ì¸ ë©”ì„œë“œì´ë‹¤. 

ë¡œê·¸ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```sh
17:35:12.687 [parallel-2] INFO reactive.signal.OldSchool -- # create() : task1 result
17:35:12.689 [parallel-2] INFO reactive.signal.OldSchool -- # create() : task2 result
17:35:12.689 [parallel-2] INFO reactive.signal.OldSchool -- # create() : task3 result
17:35:12.689 [parallel-2] INFO reactive.signal.OldSchool -- # create() : task4 result
17:35:12.689 [parallel-2] INFO reactive.signal.OldSchool -- # create() : task5 result
17:35:12.689 [boundedElastic-1] INFO reactive.signal.OldSchool -- # map(): task1 result success!!
17:35:12.689 [boundedElastic-1] INFO reactive.signal.OldSchool -- # map(): task2 result success!!
17:35:12.689 [boundedElastic-1] INFO reactive.signal.OldSchool -- # map(): task3 result success!!
17:35:12.689 [boundedElastic-1] INFO reactive.signal.OldSchool -- # map(): task4 result success!!
17:35:12.689 [boundedElastic-1] INFO reactive.signal.OldSchool -- # map(): task5 result success!!
17:35:12.689 [parallel-1] INFO reactive.signal.OldSchool -- # onNext(): task1 result success!!
17:35:12.689 [parallel-1] INFO reactive.signal.OldSchool -- # onNext(): task2 result success!!
17:35:12.689 [parallel-1] INFO reactive.signal.OldSchool -- # onNext(): task3 result success!!
17:35:12.689 [parallel-1] INFO reactive.signal.OldSchool -- # onNext(): task4 result success!!
17:35:12.689 [parallel-1] INFO reactive.signal.OldSchool -- # onNext(): task5 result success!!
```

ë³´ë©´, ì“°ë ˆë“œ ëª…ì´ ë‹¤ ë‹¤ë¥¸ì ì„ ë³¼ ìˆ˜ê°€ ìˆë‹¤. ì´ ë¶€ë¶„ì€ ë‹¤ìŒ ìŠ¤í…ì—ì„œ ë‹¤ë£° ì˜ˆì •ì´ë‹¤. (`Schedulers.parallel()`ê³¼ ê°™ì€ê²ƒ)
ë‹¤í–‰íˆë„ `doTasks()` ë©”ì„œë“œëŠ” ì´ˆê¸° ì‹¤í–‰í–ˆë˜ ì“°ë ˆë“œ ë‚´ì—ì„œ ë™ì‘ì„ í•´ì„œ ë¬¸ì œê°€ ì—†ì—ˆë‹¤. 

ê·¸ëŸ¬ë©´ ë§Œì•½, ì´ `doTasks()` ë©”ì„œë“œê°€ ë©€í‹°ì“°ë ˆë“œë¡œ ë™ì‘í•˜ê²Œ ë˜ë©´ ì–´ë–¤ì¼ì´ ë²Œì–´ì§ˆê¹Œ?

```java
public static void main(String[] args) throws InterruptedException {  
	Flux<String> flux = Flux.create(sink -> {  

		new Thread(() -> {  
			for (int i = 0; i < 100; i++) {  
				sink.next("Thread 1 - " + i);  
			}  
		}).start();  
  
		
		new Thread(() -> {  
			for (int i = 0; i < 100; i++) {  
				sink.next("Thread 2 - " + i);  
			}  
		}).start();  
	});  
  
	flux.subscribe(System.out::println);  
  
	Thread.sleep(3000);  
}
```

ìœ„ì˜ ì˜ˆì‹œì²˜ëŸ¼ ê°ê° ë³„ê°œì˜ ì“°ë ˆë“œì—ì„œ ë°ì´í„°ë¥¼ ë°©ì¶œí•˜ëŠ” ì˜ˆì œê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ì´ëŸ¬í•œ ì¼€ì´ìŠ¤ì— ë‘ ì“°ë ˆë“œì—ì„œ ë°©ì¶œë˜ëŠ” ë°ì´í„°ë¡œ ë‹¤ì‹œ ê°€ê³µì²˜ë¦¬ë¥¼ í•˜ë ¤ê³  í•œë‹¤ê³  ë³´ë©´ ëˆ„ë½ì´ ë˜ê±°ë‚˜ ì˜ëª» ë°©ì¶œëœ ë°ì´í„° ë“±ì´ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. ì¦‰, `Flux.create()` ë¡œ ì „ë‹¬ë˜ëŠ” `FluxSink`ëŠ” **ì“°ë ˆë“œ ì•ˆì •ì„±ì„ ë³´ì¥í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤.** 

`Sinks`ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì£¼ì—ˆë‹¤ê³  ë³´ë©´ëœë‹¤.

```java
public static void main(String[] args) throws InterruptedException {  
	int tasks = 6;  
  
	Sinks.Many<String> unicastSinks = Sinks.many()  
											.unicast()  
											.onBackpressureBuffer();  
  
	Flux<String> flux = unicastSinks.asFlux();  
  
	IntStream.range(1, tasks)  
			.forEach(n -> {  
				try {  
					new Thread(() -> {  
						unicastSinks.emitNext(doTasks(n), Sinks.EmitFailureHandler.FAIL_FAST); // ë©€í‹°ì“°ë ˆë“œ ì‘ì—…
						log.info("# emitted: {}", n);  
					}).start();  
  
				Thread.sleep(100L);  
  
				} catch (InterruptedException e) {  
					log.error(e.getMessage());  
				}  
			});  
  
	flux.publishOn(Schedulers.parallel())  
			.map(result -> result + " success!!")  
			.doOnNext(n -> log.info("# map(): {}", n))  
		.publishOn(Schedulers.parallel())  
		.subscribe(data -> log.info("# onNext() : {}", data));  
  
	Thread.sleep(200L);  
}
```

ì´ ì½”ë“œì˜ ê²°ê³¼ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```sh
17:56:52.598 [Thread-0] INFO reactive.signal.SinksExample -- # emitted: 1
17:56:52.696 [Thread-1] INFO reactive.signal.SinksExample -- # emitted: 2
17:56:52.801 [Thread-2] INFO reactive.signal.SinksExample -- # emitted: 3
17:56:52.905 [Thread-3] INFO reactive.signal.SinksExample -- # emitted: 4
17:56:53.011 [Thread-4] INFO reactive.signal.SinksExample -- # emitted: 5
17:56:53.140 [parallel-2] INFO reactive.signal.SinksExample -- # map(): task1 result success!!
17:56:53.141 [parallel-2] INFO reactive.signal.SinksExample -- # map(): task2 result success!!
17:56:53.141 [parallel-1] INFO reactive.signal.SinksExample -- # onNext() : task1 result success!!
17:56:53.141 [parallel-2] INFO reactive.signal.SinksExample -- # map(): task3 result success!!
17:56:53.141 [parallel-1] INFO reactive.signal.SinksExample -- # onNext() : task2 result success!!
17:56:53.141 [parallel-1] INFO reactive.signal.SinksExample -- # onNext() : task3 result success!!
17:56:53.141 [parallel-2] INFO reactive.signal.SinksExample -- # map(): task4 result success!!
17:56:53.141 [parallel-2] INFO reactive.signal.SinksExample -- # map(): task5 result success!!
17:56:53.141 [parallel-1] INFO reactive.signal.SinksExample -- # onNext() : task4 result success!!
17:56:53.141 [parallel-1] INFO reactive.signal.SinksExample -- # onNext() : task5 result success!!
```

ìƒˆë¡œìš´ ì“°ë ˆë“œë¥¼ í†µí•´ì„œ `emitNext()` ë©”ì„œë“œë¥¼ í†µí•´ì„œ 1ë¶€í„° 6ê¹Œì§€ ë°ì´í„°ê°€ ìƒì„±ë˜ëŠ” ìƒí™©ì´ì§€ë§Œ ë¬¸ì œì—†ì´ ì‘ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
ì´ëŸ°ì‹ìœ¼ë¡œ `Sinks`ëŠ” ë©€í‹°ì“°ë ˆë“œì˜ ì•ˆì •ì„±ì„ ê°€ì ¸ê°”ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

ì´ ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°€ì§€ íŠ¹ì„±ì´ ë” ìˆëŠ”ë° ì´ëŠ” ë‹¤ìŒ ìŠ¤í…ì—ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤.

### STEP 3.2 Sinks íŠ¹ì§• 

ì ê¹ ìœ„ì˜ ì½”ë“œì—ì„œ `Sinks` ë¥¼ ì„ ì–¸í•˜ëŠ” ë¶€ë¶„ ì½”ë“œë¥¼ ê°€ì ¸ì™€ë³´ê² ë‹¤.

```java
...
Sinks.Many<String> unicastSinks = Sinks.many()  
										.unicast()  
										.onBackpressureBuffer();  
...
```

`Many`ë¼ëŠ” ê°’ì„ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ ì´ ê°’ì€ 0 ~ Nê°œì˜ ë°ì´í„°ê°€ ë°©ì¶œê°€ëŠ¥í•œ `Flux`ì™€ ë¹„ìŠ·í•œ ê°œë…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.
ê·¸ë ‡ë‹¤ë©´, `Mono`ëŠ” ì—†ëŠ”ê°€? `Sinks.One()` ê°€ ë°”ë¡œ `Mono`ì™€ ëŒ€ì¹˜ëœë‹¤ê³  ë³´ë©´ëœë‹¤.

ì½”ë“œë¡œ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ `Mono` ë‚˜ `Flux`ë¡œ ë³€í™˜ì„ í•  ìˆ˜ ìˆë‹¤.

```java
Sinks.One<Object> sinksOne = Sinks.one();  
Mono<Object> mono = sinksOne.asMono();  
  
Sinks.Many<String> manySinks = Sinks.many().unicast().onBackpressureBuffer();  
Flux<String> flux = manySinks.asFlux();
```

ê·¸ë ‡ë‹¤ë©´, ë°ì´í„° ë°©ì¶œì€ ì–´ë–»ê²Œ í•  ìˆ˜ ìˆì„ê¹Œ?

```java
Sinks.One<Object> sinksOne = Sinks.one();  
Mono<Object> mono = sinksOne.asMono();  
  
sinksOne.emitValue("Hello", Sinks.EmitFailureHandler.FAIL_FAST);  
  
mono.subscribe(data -> log.info("{}", data));
```

ìœ„ì™€ ê°™ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ê·¼ë° `emitValue()`ì˜ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ `Sinks.EmitFailureHandler.FAIL_FAST` ì€ ë¬´ì—‡ì¼ê¹Œ?
ì´ëŠ” ë©€í‹°ì“°ë ˆë“œ ì˜ˆì‹œ ì½”ë“œì—ì„œë„ ë´¤ë˜ ë‚´ìš©ì´ë‹¤. `Publisher` ìª½ì—ì„œ ë°ì´í„° ë°©ì¶œì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ì²˜ë¦¬ë˜ëŠ” í•¸ë“¤ëŸ¬ë¡œ `FAIL_FAST` ì „ëµì„ ì·¨í•˜ë©´ ì¬ì‹œë„ í•˜ì§€ ì•Šê³  ì¦‰ì‹œ ì‹¤íŒ¨ì²˜ë¦¬í•˜ëŠ” ì „ëµì´ë‹¤.
`Sinks`ëŠ” ì´ëŸ¬í•œ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¥¼ í†µí•´ì„œ ì“°ë ˆë“œ ê°„ì˜ ê²½í•© ë“±ìœ¼ë¡œ ë°œìƒí•˜ëŠ” êµì°© ìƒíƒœë“±ì„ ë¯¸ì—°ì— ë°©ì§€í•˜ê²Œë” ì„¤ê³„ë˜ì—ˆë‹¤.

`Sinks.many()`ì¸ ê²½ìš°ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ìŠ¤í™ë“¤ì´ ì¡´ì¬í•œë‹¤.

```java
public interface ManySpec {  
	UnicastSpec unicast();  
	MulticastSpec multicast();  
	MulticastReplaySpec replay();  
}
```

ê° ìŠ¤í™ë³„ íŠ¹ì§•ì„ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

| ìŠ¤í™ ì¢…ë¥˜           | íŠ¹ì§•                                                                                                   | ì„ ì–¸ ë°©ë²•           |
| ------------------- | ------------------------------------------------------------------------------------------------------ | ------------------- |
| UnicastSpec         | 1ê°œì˜ `Subscriber`ë§Œ êµ¬ë… ê°€ëŠ¥í•œ `Publisher` ìŠ¤í™ì´ë‹¤                                                  | `Sinks.unicast().onBackpressureBuffer()`   |
| MulticastSpec      | Nê°œì˜ `Subscriber`ê°€ êµ¬ë… ê°€ëŠ¥í•œ `Publisher` ìŠ¤í™ì´ë‹¤                                                  | `Sinks.multicast().onBackpressureBuffer()` |
| MulticastReplaySpec | Nê°œì˜ `Subscriber`ê°€ êµ¬ë… ê°€ëŠ¥í•œ `Publisher` ìŠ¤í™ì´ë©°, ë°©ì¶œëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë°©ì¶œí•˜ëŠ” ê¸°ëŠ¥ì„ ê°–ê³  ìˆë‹¤. | `Sinks.replay().onBackpressureBuffer()`    |

JPAë‘ ë¹„êµí•˜ìë©´, `UnicastSpec`ì€ `@OneToOne` ì´ë¼ê³  ë³¼ ìˆ˜ ìˆê³  `MulticastSpec`ì€ `@OneToMany`ì™€ ë¹„ìŠ·í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.
ë˜í•œ, `MulticastSpec`ì€ ìœ„ì—ì„œ ì–˜ê¸°í•œ Hot Sequenceì˜ íŠ¹ì§•ì„ ì§€ë‹ˆê³  ìˆê¸°ì— ë‹¤ì‹œ ê¸°ì¡´ ë°ì´í„°ë¥¼ ë°©ì¶œì„ í•´ì•¼í•  ê²½ìš°ì— `MulticastReplaySpec`ì„ ì‚¬ìš©í•œë‹¤.
ë’¤ì— `onBackPressureBuffer()` ë©”ì„œë“œëŠ” ë°°ì••ì„ ì„¤ëª…í•˜ë©´ì„œ ê°™ì´ ì„¤ëª…í•˜ë„ë¡ í•˜ê² ë‹¤.

ê·¸ ì „ì— ì‹¤ì œ ì‚¬ìš©ë°©ë²•ì„ ì½”ë“œë¡œ í™•ì¸í•´ë³´ì

+ `UnicastSpec` êµ¬í˜„ ì½”ë“œ

```java
public static void main(String[] args) {  
  
	Sinks.Many<String> unicastSinks = Sinks.many().unicast().onBackpressureBuffer();  
  
	unicastSinks.emitNext("Hello", Sinks.EmitFailureHandler.FAIL_FAST);  
	unicastSinks.emitNext("World", Sinks.EmitFailureHandler.FAIL_FAST);  
  
	Flux<String> flux = unicastSinks.asFlux();  
  
	flux.subscribe(data -> log.info("{}", data));
	// flux.subscribe(data -> log.info("{}", data)); ì£¼ì„ì„ í’€ë©´ IllegalStateException : Sinks.many().unicast() sinks only allow a single Subscriber ë¼ëŠ” ì—ëŸ¬ê°€ ëœ¨ëŠ”ë° êµ¬ë…ì„ 1ê°œë§Œ ë“±ë¡í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
}
```

+ `MulticastSpec` êµ¬í˜„ ì½”ë“œ

```java
...

Sinks.Many<String> multicastSinks = Sinks.many().multicast().onBackpressureBuffer();  
Flux<String> flux2 = multicastSinks.asFlux();  
  
  
multicastSinks.emitNext("Hello", Sinks.EmitFailureHandler.FAIL_FAST);  
multicastSinks.emitNext("World", Sinks.EmitFailureHandler.FAIL_FAST);  
  
flux2.subscribe(data -> log.info("# Subscriber-1 {}", data));  
  
flux2.subscribe(data -> log.info("# Subscriber-2 {}", data));  
  
multicastSinks.emitNext("Reactor", Sinks.EmitFailureHandler.FAIL_FAST);

...
```

ìœ„ì—ì„œ ì–˜ê¸°í•œ ê²ƒì²˜ëŸ¼ `MulticastSpec` ì˜ ê²½ìš°ì—ëŠ” Hot Sequenceì˜ íŠ¹ì§•ì„ ê°€ì§€ê²Œ ëœë‹¤. 
ê·¸ë˜ì„œ ë¡œê·¸ë¥¼ ì°ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.

+ ê²°ê³¼

```sh
21:02:06.163 [main] INFO reactive.sinks.SinkManyExample -- # Subscriber-1 Hello
21:02:06.163 [main] INFO reactive.sinks.SinkManyExample -- # Subscriber-1 World
21:02:06.163 [main] INFO reactive.sinks.SinkManyExample -- # Subscriber-1 Reactor
21:02:06.163 [main] INFO reactive.sinks.SinkManyExample -- # Subscriber-2 Reactor
```

ë”°ë¼ì„œ 2ë²ˆì§¸ `Subscriber`ëŠ” êµ¬ë… ì´ì „ ì‹œì ì— ë°©ì¶œëœ ë°ì´í„°ëŠ” ë°›ì„ ìˆ˜ê°€ ì—†ê³ , `Reactor`ë§Œ ë°›ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
ë§Œì•½, ì´ë•Œ ì´ì „ ë°©ì¶œ ë°ì´í„°ë¥¼ ë°›ê³ ì í•˜ë©´ ì–´ë–»ê²Œ í•´ì•¼ë ê¹Œ? 

ê·¸ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ë¡œ `MulticastReplaySpec`ì´ë‹¤.

+ `MulticastReplaySpec` êµ¬í˜„

```java
...

Sinks.Many<String> multicastReplaySinks = Sinks.many().replay().all();  
Flux<String> flux3 = multicastReplaySinks.asFlux();  
  
multicastReplaySinks.emitNext("Hello", Sinks.EmitFailureHandler.FAIL_FAST);  
multicastReplaySinks.emitNext("World", Sinks.EmitFailureHandler.FAIL_FAST);  
  
flux3.subscribe(data -> log.info("# Replay Subscriber-1 {}", data));  
  
flux3.subscribe(data -> log.info("# Replay Subscriber-2 {}", data));  
  
multicastReplaySinks.emitNext("Reactor", Sinks.EmitFailureHandler.FAIL_FAST);
...
```

+ ê²°ê³¼

```sh
21:06:56.887 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-1 Hello
21:06:56.887 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-1 World
21:06:56.888 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-2 Hello
21:06:56.888 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-2 World
21:06:56.888 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-1 Reactor
21:06:56.888 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-2 Reactor
```

ì—¬ê¸°ì„œ `replay().all()` ë©”ì„œë“œëŠ” ë‹¤ì‹œ ëª¨ë“  ë°ì´í„°ë¥¼ ë°©ì¶œí•˜ëŠ” ë©”ì„œë“œì´ë‹¤. `limit()` ê³¼ ê°™ì´ ì´ì „ì— ëª‡ê°œê¹Œì§€ë§Œ ë˜ëŒë ¤ì„œ ë°©ì¶œí•  ìˆ˜ë„ ìˆë‹¤.

`Sinks.Many<String> multicastReplaySinks = Sinks.many().replay().limit(1); `

+ ê²°ê³¼

```sh
21:09:04.768 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-1 World
21:09:04.768 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-2 World
21:09:04.768 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-1 Reactor
21:09:04.768 [main] INFO reactive.sinks.SinkManyExample -- # Replay Subscriber-2 Reactor
```

ë§ˆì§€ë§‰ ê²°ê³¼ì¸ "Reactor" ì§ì „ ê°’ì¸ "World"ê¹Œì§€ ì°íˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### STEP 3.3 ë°°ì••(Backpressure)

ìœ„ì—ì„œ `Sinks.multicast().onBackpressureBuffer()` ì™€ ê°™ì´ ì„ ì–¸í•˜ëŠ” ë¶€ë¶„ì„ ìš°ë¦¬ëŠ” ë³´ì•˜ì—ˆë‹¤.
ê·¸ë ‡ë‹¤ë©´ BackpressureëŠ” ë²ˆì—­ì„œì— ì£¼ë¡œ ë°°ì••ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤. ê·¸ë ‡ë‹¤ë©´ `onBackpressureBuffer()` ëŠ” ë¬´ì–¸ê°€ ë°°ì••ì²˜ë¦¬ë¥¼ ìœ„í•œ ë²„í¼ë¥¼ ì„ ì–¸í•˜ëŠ” ê²ƒì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤.

ê·¸ëŸ¬ë©´ ë°°ì••ì´ë€ ë¬´ì—‡ì¼ê¹Œ? ë¦¬ì•¡í‹°ë¸Œ ì„ ì–¸ë¬¸ì„ ì˜ ê¸°ì–µí•˜ë©´ ë¹„ë™ê¸° ë©”ì‹œì§€ ê¸°ë°˜ í†µì‹  ìœ„ì—ì„œ ì´ë¤„ì§„ë‹¤ê³  í•˜ì˜€ë‹¤.

> ê·¸ë ‡ë‹¤ë©´, ë§Œì•½ì— `Publisher`ê°€ `Subscriber`ê°€ ì²˜ë¦¬í•˜ëŠ” ì†ë„ë³´ë‹¤ ë¹ ë¥´ê²Œ ë°ì´í„°ë¥¼ ë°©ì¶œí•˜ê²Œ ë  ê²½ìš° ì–´ë–»ê²Œ ë ê¹Œ? 
> ë°˜ëŒ€ë¡œ `Subscriber`ê°€ ì²˜ë¦¬í•˜ëŠ” ì†ë„ê°€ ë¹¨ë¼ `Publisher` ê°€ ë°©ì¶œí•˜ëŠ” ë°ì´í„° ì†ë„ê°€ ëŠë¦¬ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

ì´ ë‘ ê°€ì§€ ë‚´ìš©ì„ ë°”ë¡œ "Producer-consumer problem"[^13] ì´ë¼ ë¶€ë¥¸ë‹¤. ì´ ë¬¸ì œì— ëŒ€í•´ì„œ ë‹¤ë£¨ê¸°ì—ëŠ” ë²”ìœ„ê°€ ë²—ì–´ë‚˜ë¯€ë¡œ ë…ìë¶„ë“¤ê»˜ì„œ ê²€ìƒ‰ì„ í†µí•´ì„œ í™•ì¸í•´ë³´ê¸° ë°”ë€ë‹¤.
ê²°ë¡ ì ìœ¼ë¡œ ì´ íë¦„ ì œì–´ í˜¹ì€ ì†ë„ ì œì–´ë¥¼ ì ì ˆí•˜ê²Œ ìˆ˜í–‰í•´ì•¼ ë¦¬ì•¡í‹°ë¸Œ ì„ ì–¸ë¬¸ì— ì‘ì„±ëœ íƒ„ë ¥ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ê·¸ëŸ¬í•œ ì—­í• ì„ í•˜ëŠ” ê²ƒì´ ë°°ì••ì´ë‹¤.  ìœ„ì—ì„œ ë¦¬ì•¡í„° í”„ë¡œê·¸ë˜ë°ì„ ì„¤ëª…í•  ë•Œ `Subscription`ì˜ `request()` ë©”ì„œë“œì— ê°¯ìˆ˜ë¥¼ í†µí•´ì„œ ëª‡ê°œì”©ë§Œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ì‹ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ê³  í•˜ì˜€ë‹¤.
ì´ ë¶€ë¶„ì€ ìƒëµí•˜ê³  ë°°ì•• ì „ëµì—ì„œë§Œ ë³´ê³ ì í•œë‹¤.

### STEP 3.3.1 ë°°ì•• ì „ëµ

| ì¢…ë¥˜     | íŠ¹ì§•                                                                                                             | ì„ ì–¸ ë°©ë²•                 |
| -------- | ---------------------------------------------------------------------------------------------------------------- | ------------------------- |
| `IGNORE` | ë°°ì••ì„ ì ìš©í•˜ì§€ ì•ŠëŠ” ì „ëµ                                                                                        | ìƒëµ                      |
| `ERROR`  | ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ë‹¬í•  ë°ì´í„°ê°€ ë²„í¼ì— ê°€ë“ ì°° ê²½ìš°, `Exception` ë°œìƒì‹œí‚¤ëŠ” ì „ëµ                                  | `.onBackpressureError()`  |
| `DROP`   | ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ë‹¬í•  ë°ì´í„°ê°€ ë²„í¼ì— ê°€ë“ ì°° ê²½ìš°, ë²„í¼ ë°– ë°©ì¶œëœ ë°ì´í„°ë¥¼ ë²„ë¦¬ëŠ” ì „ëµ                          | `.onBackpressureDrop()`   |
| `LATEST` | ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ë‹¬í•  ë°ì´í„°ê°€ ë²„í¼ì— ê°€ë“ ì°° ê²½ìš°, ë²„í¼ ë°–ì—ì„œ ê°€ì¥ ìµœê·¼ì— ë°©ì¶œëœ ë°ì´í„°ë¶€í„° ë²„í¼ì— ì±„ìš°ëŠ” ì „ëµ | `.onBackpressureLatest()` |
| `BUFFER` | ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ë‹¬í•  ë°ì´í„°ê°€ ë²„í¼ì— ê°€ë“ ì°° ê²½ìš°, ë²„í¼ ì•ˆì— ìˆëŠ” ë°ì´í„°ë¶€í„° ë²„ë¦¬ëŠ” ì „ëµ                        | `.onBackpressureBuffer()`                          |

ê° ì „ëµì— ëŒ€í•´ì„œ ì½”ë“œë¥¼ ì‚´í´ë³´ì.

+ `ERROR` ì „ëµ 

```java
public static void main(String[] args) throws InterruptedException {  
	Flux  
		.interval(Duration.ofMillis(1L))  
		.onBackpressureError()  
		.doOnNext(data -> log.info("# doOnNext: {}", data))  
		.publishOn(Schedulers.parallel())  
		.subscribe(data -> {  
			try {  
				Thread.sleep(5L);  
			} catch (InterruptedException e) {}  
				log.info("# onNext: {}", data);  
			},  
			error -> log.error("# onError", error)
		);  
  
	Thread.sleep(2000L);  
}
```

+ ê²°ê³¼ 

```sh
...
21:30:24.254 [parallel-1] INFO backpressure.BackPressureStrategyEx1 -- # onNext: 254
21:30:24.259 [parallel-1] INFO backpressure.BackPressureStrategyEx1 -- # onNext: 255
21:30:24.260 [parallel-1] ERROR backpressure.BackPressureStrategyEx1 -- # onError
reactor.core.Exceptions$OverflowException: The receiver is overrun by more signals than expected (bounded queue...)
	at reactor.core.Exceptions.failWithOverflow(Exceptions.java:236)
...
```

+ ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨

![](https://i.imgur.com/ObLmi1n.png)


ë°°ì•• ë²„í¼ëŠ” ë³„ë„ ì„¤ì •ì´ ì—†ë‹¤ë©´ ê¸°ë³¸ ì‚¬ì´ì¦ˆê°€ 255ê°œì´ë‹¤. ê·¸ëŸ¬ë‹ˆ 256ê°œì§¸ ë°ì´í„°ê°€ ì¸ì…ë˜ë ¤ê³  í•˜ëŠ” ìˆœê°„ ìµì…‰ì…˜ì´ ë°œìƒí•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ê°€ ìˆë‹¤.

+ `DROP` ì „ëµ 

```java
public static void main(String[] args) throws InterruptedException {  
	Flux  
		.interval(Duration.ofMillis(1L))  
		.onBackpressureDrop(dropped -> log.info("# dropped: {}", dropped))  
		.publishOn(Schedulers.parallel())  
		.subscribe(data -> {  
			try {  
				Thread.sleep(5L);  
			} catch (InterruptedException e) {}  
				log.info("# onNext: {}", data);  
			},  
			error -> log.error("# onError", error)
		);  
  
	Thread.sleep(2000L);  
}
```

+ ê²°ê³¼

```sh
...
21:32:30.255 [parallel-1] INFO backpressure.BackPressureStrategyEx2 -- # onNext: 40
21:32:30.255 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 256
21:32:30.256 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 257
21:32:30.257 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 258
21:32:30.258 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 259
21:32:30.259 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 260
21:32:30.260 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 261
21:32:30.261 [parallel-2] INFO backpressure.BackPressureStrategyEx2 -- # dropped: 262
21:32:30.261 [parallel-1] INFO backpressure.BackPressureStrategyEx2 -- # onNext: 41
...
```

+ ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨

![](https://i.imgur.com/SROqaTm.png)

ë²„í¼ì— ë“¤ì–´ê°€ìˆëŠ” ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ê¸° ì´ì „ì— ë¹ ë¥´ê²Œ `Publisher`ê°€ ë°ì´í„°ë¥¼ ë°©ì¶œí•˜ê³  ìˆëŠ” ìƒí™©ì´ë©°, ë²„í¼ì— ì¸ì…ë˜ì§€ ì•Šì€ ë°©ì¶œ ë°ì´í„°ëŠ” ë²„ë¦¬ëŠ” ì „ëµì´ë‹¤.

+ `LATEST` ì „ëµ

```java
public static void main(String[] args) throws InterruptedException {  
	Flux  
		.interval(Duration.ofMillis(1L))  
		.onBackpressureLatest()  
		.publishOn(Schedulers.parallel())  
		.subscribe(data -> {  
			try {  
				Thread.sleep(5L);  
			} catch (InterruptedException e) {}  
				log.info("# onNext: {}", data);  
			}
		);  
  
	Thread.sleep(2000L);  
}
```

+ ê²°ê³¼

```sh
...
21:35:02.193 [parallel-1] INFO backpressure.BackPressureStrategyEx3 -- # onNext: 254
21:35:02.199 [parallel-1] INFO backpressure.BackPressureStrategyEx3 -- # onNext: 255
21:35:02.206 [parallel-1] INFO backpressure.BackPressureStrategyEx3 -- # onNext: 1180
21:35:02.212 [parallel-1] INFO backpressure.BackPressureStrategyEx3 -- # onNext: 1181
...
```

+ ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨

![](https://i.imgur.com/E4zYiCx.png)

ì´ ì „ëµì€ ë²„í¼ê°€ ê°€ë“ì°¨ìˆì„ ê²½ìš°ì— ê°€ì¥ ìµœê·¼ì— ì¸ì…ëœ ë°ì´í„°ë¶€í„° ì±„ì›Œë†“ëŠ”ë° ê·¸ ì „ì— ìˆëŠ” ë°ì´í„°ëŠ” ì§€ì›Œì§„ë‹¤.
ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨ì„ ë³´ë©´, ë²„í¼ì— ì£¼í™©ìƒ‰ì´ ìˆì—ˆì§€ë§Œ `request(2)` ë¥¼ ìˆ˜í–‰í–ˆì„ ì‹œì ì— ê·¸ ì „ì— ì¸ì…ëœ ì£¼í™©ìƒ‰ì€ ë‚ ë¼ê°”ê³ , ìµœì‹ ê°’ì¸ ë³´ë¼ìƒ‰ì„ ì–»ê²Œ ëœë‹¤.

+ `BUFFER` ì „ëµ

```java
public static void main(String[] args) throws InterruptedException {  
	Flux  
		.interval(Duration.ofMillis(300L))  
		.doOnNext(data -> log.info("# emitted by original Flux: {}", data))  
		.onBackpressureBuffer(2,  
			dropped -> log.info("** Overflow & Dropped: {} **", dropped),  
			BufferOverflowStrategy.DROP_LATEST
		)
		.doOnNext(data -> log.info("[ # emitted by Buffer: {}]", data))  
		.publishOn(Schedulers.parallel(), false, 1)  
		.subscribe(data -> {  
			try {  
				Thread.sleep(1000L);  
			} catch (InterruptedException e) {}  
				log.info("# onNext: {}", data);  
		}, error -> log.error("# onError", error));  
  
	Thread.sleep(3000L);  
}
```

+ ê²°ê³¼ 

```sh
...
21:46:31.853 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- # emitted by original Flux: 0
21:46:31.855 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- [ # emitted by Buffer: 0]
21:46:32.151 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- # emitted by original Flux: 1
21:46:32.451 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- # emitted by original Flux: 2
21:46:32.749 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- # emitted by original Flux: 3
21:46:32.749 [parallel-2] INFO backpressure.BackPressureStrategyEx4 -- ** Overflow & Dropped: 3 **
...
```

+ ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨

![](https://i.imgur.com/SPiVdNC.png)

ì´ ì „ëµì€ ë²„í¼ì˜ ìµœëŒ€ í¬ê¸°ë¥¼ ì„¤ì •í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì „ëµìœ¼ë¡œ ë²„í¼ì— ì¶”ê°€ë¡œ `BufferOverflowStrategy` ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.
ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨ì—ì„œëŠ” `DROP_OLDEST` ë¼ ë˜ì–´ìˆëŠ”ë° ì´ëŠ” ê°€ì¥ ì˜¤ë˜ëœ ë°ì´í„°ë¶€í„° ë²„ë¦¬ëŠ” ì „ëµì´ë‹¤.

ì¦‰, ë…¸ë€ìƒ‰ì´ ì¡´ì¬í–ˆê³  ì£¼í™©ìƒ‰ì´ ì±„ì›Œì§„ ìƒí™©ì—ì„œ ë³´ë¼ìƒ‰ì„ ë„£ì„ ë•Œ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí–ˆê³  `OLDEST` ì „ëµì´ë¯€ë¡œ ë…¸ë€ìƒ‰ì´ ì§€ì›Œì§„ ê²ƒì´ë‹¤.
ì˜ˆì‹œ ì½”ë“œëŠ” `BufferOverflowStrategy.DROP_LATEST` ë¡œ ì ìš©í–ˆê¸° ë•Œë¬¸ì— ì˜¤íˆë ¤ ë³´ë¼ìƒ‰ì´ ë²„í¼ì— ì¸ì…ì´ ì•ˆë  ê²ƒì´ë‹¤.


### STEP 3.4 ìŠ¤ì¼€ì¤„ëŸ¬

ë§ˆì§€ë§‰ìœ¼ë¡œ ì‚´í´ë³¼ ë¦¬ì•¡í„°ì˜ ë§ˆì§€ë§‰ êµ¬ì„±ìš”ì†Œ ì¤‘ í•˜ë‚˜ëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ì´ë‹¤.  ìš°ë¦¬ëŠ” ì´ë¯¸ ì´ê²ƒì„ ì˜ˆì‹œì½”ë“œë¡œ ë³´ê¸´í–ˆë‹¤.
`.subscribeOn(Schedulers.parallel())` ì™€ ê°™ì€ ì½”ë“œë“¤ì—ì„œ ì“°ì´ëŠ” ê²ƒì´ ë°”ë¡œ ìŠ¤ì¼€ì¤„ëŸ¬ì´ë‹¤.

ì´ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ë¦¬ì•¡í„°ì—ì„œ ì œê³µí•˜ëŠ” ê²ƒìœ¼ë¡œ **ì“°ë ˆë“œë¥¼ ê´€ë¦¬í•´ì£¼ëŠ” ê´€ë¦¬ì ì—­í• ì„ ìˆ˜í–‰**ì„ í•˜ëŠ”ë° ì´ë¥¼ ì„¤ëª…í•˜ê¸° ì•ì„œ ì»´í“¨íŒ…ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì“°ë ˆë“œì˜ ì¢…ë¥˜ì— ëŒ€í•´ì„œ ê°„ëµíˆ ì•Œê³  ê°ˆ í•„ìš”ê°€ ìˆë‹¤.

### STEP 3.4.1 ì“°ë ˆë“œì˜ ì¢…ë¥˜ 

ì“°ë ˆë“œëŠ” 2ê°€ì§€ ì¢…ë¥˜ê°€ ì¡´ì¬í•œë‹¤.
1. **ë¬¼ë¦¬ì  ì“°ë ˆë“œ(Physical Thread)** : ì½”ì–´ì— ë‚˜ëˆ ì§„ ì‹¤ì œ í•˜ë“œì›¨ì–´ì™€ ì—°ê´€ëœ ì“°ë ˆë“œ
2. **ë…¼ë¦¬ì  ì“°ë ˆë“œ(Logical Thread)** : ë¬¼ë¦¬ì  ì“°ë ˆë“œë¥¼ ë…¼ë¦¬ì ì¸ ë‹¨ìœ„ë¡œ ë‚˜ëˆˆ ì“°ë ˆë“œ 

í•„ìëŠ” í˜„ì¬ M1 Pro ë§¥ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë° `sysctl -a | grep cpu` ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ ë¬¼ë¦¬ì  ì“°ë ˆë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![](https://i.imgur.com/E0WejdQ.png)

ìœ„ ëª…ë ¹ì–´ì— ì˜í•˜ë©´ M1 ProëŠ” 8ê°œì˜ ì½”ì–´ë¡œ ì´ë¤„ì§„ CPUì´ê³ , ì½”ì–´ë‹¹ 1ê°œì˜ ë¬¼ë¦¬ì  ì“°ë ˆë“œë¥¼ ê°€ì§„ë‹¤ëŠ” ì ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
ë…¼ë¦¬ì  ì“°ë ˆë“œëŠ” ì´ ë¬¼ë¦¬ì  ì“°ë ˆë“œë¥¼ ì†Œí”„íŠ¸ì›¨ì–´ì ìœ¼ë¡œ ë‚˜ëˆ ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë©°, í”íˆ ìë°”ì—ì„œ ì–˜ê¸°í•˜ëŠ” ì“°ë ˆë“œëŠ” ëŒ€ë¶€ë¶„ ë…¼ë¦¬ì  ì“°ë ˆë“œì´ë‹¤.

ì´ ë‘ ê°€ì§€ ì¢…ë¥˜ì˜ ì“°ë ˆë“œì— ëŒ€í•´ì„œ ì•Œì•„ì•¼í•˜ëŠ” ì´ìœ ëŠ” ì´ ë‘ ê°€ì§€ ì“°ë ˆë“œê°€ ê°ê¸° ë‹¤ë¥¸ íŠ¹ì§•ì„ ê°–ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ë¬¼ë¦¬ì  ì“°ë ˆë“œëŠ” **ë³‘ë ¬ì„±(Parallelism)** ê³¼ ì—°ê´€ì´ ë˜ì–´ìˆëŠ”ë° ì‹¤ì œë¡œ ë™ì‹œì— ìˆ˜í–‰í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. (ì‹¤ì œ ë‚˜ëˆ ì§„ ë³„ë„ ì½”ì–´ì—ì„œ ë™ì‹œ ìˆ˜í–‰)
ë…¼ë¦¬ì  ì“°ë ˆë“œëŠ” **ë™ì‹œì„±(Concurrency)** ì™€ ì—°ê´€ì´ ë˜ì–´ìˆëŠ”ë° ì´ëŠ” ì‚¬ëŒ ëˆˆì—ëŠ” ë™ì‹œì— ìˆ˜í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì¸ê°„ì˜ ëˆˆìœ¼ë¡œ ì¸ì§€ê°€ ë¶ˆê°€ëŠ¥í•œ ë§¤ìš° ì§§ì€ ì†ë„ë¡œ ì„œë¡œ ì“°ë ˆë“œê°„ ë¬¸ë§¥êµí™˜ì´ ì´ë¤„ì§€ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ ë‚´ìš©ì´ ì¢€ ë” ê¶ê¸ˆí•˜ë©´ ì•„ë˜ì˜ ì°¸ê³ ìë£Œë¥¼ í™•ì¸í•´ë³´ì.
+ [Concurrency vs Parallelism - MANNING FREE CONTENT CENTER](https://freecontent.manning.com/concurrency-vs-parallelism/)

### STEP 3.4.2 ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ë™ì‘ ì›ë¦¬ 

ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ì¼ë‹¨ ì „ìš© ì—°ì‚°ì(Operator)ê°€ ì¡´ì¬í•œë‹¤ ê·¸ê²ƒì´ `subscribeOn` ì´ë‚˜ `publishOn`ê³¼ ê°™ì€ ì—°ì‚°ìì´ë‹¤. 
ê·¸ëŸ¬ë©´ ì „ë‹¬ëœ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜í•´ì„œ ë‹¤ìŒ ì—°ì‚°ì€ ì „ë‹¬ëœ ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ì¢…ë¥˜ì— ë”°ë¥¸ ì“°ë ˆë“œì— í•´ë‹¹ ì‘ì—…ì´ í• ë‹¹ë˜ê²Œ ë˜ëŠ” ë°©ì‹ì´ë‹¤.

+ `subscribeOn` ì˜ˆì‹œì½”ë“œ

```java
public static void main(String[] args) throws InterruptedException {  
	Flux.fromArray(new Integer[]{1, 2, 3})  
		.subscribeOn(Schedulers.parallel())  
		.doOnNext(data -> log.info("{}", data))  
		.doOnSubscribe(subscription -> log.info("# doOnSubscribe"))  
		.subscribe(data -> log.info("{}", data));  
  
	Thread.sleep(100L);  
}
```

+ ê²°ê³¼ 

```sh
22:24:27.487 [main] INFO reactive.schedule.SubscribeOnEx -- # doOnSubscribe
22:24:27.490 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # doOnNext 1
22:24:27.491 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # onNext 1
22:24:27.491 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # doOnNext 2
22:24:27.491 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # onNext 2
22:24:27.491 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # doOnNext 3
22:24:27.491 [boundedElastic-1] INFO reactive.schedule.SubscribeOnEx -- # onNext 3
...
```

ì´ˆê¸°ì—ëŠ” `main` ì“°ë ˆë“œì—ì„œ êµ¬ë…ì´ ìˆ˜í–‰ë˜ì—ˆê³ , ì´í›„ `boundedElastic-1` ì“°ë ˆë“œì—ì„œ ìˆ˜í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  `doOnNext` ì´í›„ ì—°ì‚°ì—ì„œëŠ” ë³„ë„ `Scheduler` ë¥¼ ì ìš©í•˜ì§€ ì•Šì•„ `subscribe`ì˜ ê²°ê³¼ ì—­ì‹œ `boundedElastic-1` ì“°ë ˆë“œì—ì„œ ìˆ˜í–‰ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

+ `publishOn` ì˜ˆì‹œì½”ë“œ

```java
public static void main(String[] args) throws InterruptedException {  
	Flux.fromArray(new Integer[] {1, 2, 3})  
		.doOnNext(data -> log.info("# doOnNext() : {}", data))  
		.doOnSubscribe(subscription -> log.info("# doOnSubscribe"))  
		.publishOn(Schedulers.parallel())  
		.subscribe(data -> log.info("# onNext() : {}", data));  
  
	Thread.sleep(100L);  
}
```

+ ê²°ê³¼ 

```sh
22:30:25.355 [main] INFO reactive.schedule.PublishOnEx -- # doOnSubscribe
22:30:25.360 [main] INFO reactive.schedule.PublishOnEx -- # doOnNext() : 1
22:30:25.361 [main] INFO reactive.schedule.PublishOnEx -- # doOnNext() : 2
22:30:25.361 [main] INFO reactive.schedule.PublishOnEx -- # doOnNext() : 3
22:30:25.361 [parallel-1] INFO reactive.schedule.PublishOnEx -- # onNext() : 1
22:30:25.361 [parallel-1] INFO reactive.schedule.PublishOnEx -- # onNext() : 2
22:30:25.361 [parallel-1] INFO reactive.schedule.PublishOnEx -- # onNext() : 3
```

`PublishOn()` ë©”ì„œë“œëŠ” ì´í›„ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼(`subscribe()`)ì˜ ë™ì‘ì— ëŒ€í•œ ì“°ë ˆë“œ ì œì–´ë¥¼ í•  ìˆ˜ ìˆë‹¤.
ê·¸ë˜ì„œ ë¡œê·¸ë¥¼ ë³´ë©´ ì´ˆê¸° êµ¬ë… ë°œìƒ ì‹œì—ëŠ” ë©”ì¸ ì“°ë ˆë“œë¡œ ë™ì‘í•˜ì˜€ìœ¼ë‚˜ `publishOn(Schedulers.parallel())`  ì´í›„ ì²˜ë¦¬ëŠ” `parallel-1` ì“°ë ˆë“œì—ì„œ ë™ì‘í•¨ì„ ë³¼ ìˆ˜ ìˆë‹¤.

ìœ„ ê²°ê³¼ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

<p align="center">
    <img src="https://i.imgur.com/zcVz4iU.png">
</p>
<p align="center">
    <em>ê·¸ë¦¼ 8. ì•„ë¬´ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì ìš©ì•ˆëì„ ë•Œ ê²½ìš°</em>
</p>

ë³„ë„ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •ì´ ì—†ë‹¤ë©´ ìœ„ì™€ ê°™ì´ ëª¨ë“  ì—°ì‚°ì´ ì „ë¶€ ë©”ì¸ì“°ë ˆë“œì—ì„œ ë™ì‘í•  ê²ƒì´ë‹¤. 
ê·¸ëŸ¬ë©´ ìœ„ ì˜ˆì‹œì— ë³¸ ê²ƒì²˜ëŸ¼ `publishOn()`ì´ ì¶”ê°€ë˜ë©´ ì–´ë–¤ì‹ìœ¼ë¡œ ë³€ê²½ë ê¹Œ?

<p align="center">
    <img src="https://i.imgur.com/sf2blBp.png">
</p>
<p align="center">
    <em>ê·¸ë¦¼ 9. publishOnì´ ì¤‘ê°„ì— ì¶”ê°€ëœ ê²½ìš°</em>
</p>

ì´ëŸ°ì‹ìœ¼ë¡œ `publishOn` ì— ì „ë‹¬ëœ ìŠ¤ì¼€ì¤„ëŸ¬ì— ë”°ë¥¸ ì“°ë ˆë“œë¡œ ë³€ê²½ì´ ë  ê²ƒì´ë‹¤.
ê·¸ëŸ¬ë©´ ë˜ `publishOn` ì„ ì¶”ê°€í•´ë„ ì“°ë ˆë“œê°€ ë‹¤ì‹œ ë³€ê²½ì´ ë ê¹Œ?


<p align="center">
    <img src="https://i.imgur.com/X5bwYke.png">
</p>
<p align="center">
    <em>ê·¸ë¦¼ 9. publishOnì„ 2ë²ˆ ì ìš©í•œ ê²½ìš°</em>
</p>


ì‹¤ì œë¡œ ì¤‘ê°„ ì—°ì‚° ì‚¬ì´ì— `publishOn()` ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ë©´ ì“°ë ˆë“œê°€ ë³€ê²½ì´ ëœë‹¤. ì´ë¥¼ ì½”ë“œë¡œ í‘œí˜„í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```java
public static void main(String[] args) throws InterruptedException {  
	Flux.fromArray(new Integer[]{1, 3, 5, 7})  
		.doOnSubscribe(subscription -> log.info("# doOnSubscribe"))
		.publishOn(Schedulers.boundedElastic())  
			.doOnNext(data -> log.info("# doOnNext fromArray: {}", data))  
		.filter(data -> data > 3)  
			.doOnNext(data -> log.info("# doOnNext filter: {}", data))  
		.publishOn(Schedulers.parallel())  
			.map(data -> data * 10)  
			.doOnNext(data -> log.info("# doOnNext map: {}", data))  
		.subscribe(data -> log.info("# onNext: {}", data));  
  
	Thread.sleep(500L);  
}
```

+ ê²°ê³¼

```sh
22:41:23.504 [main] INFO reactive.schedule.MultiplePublishOnEx -- # doOnSubscribe
22:41:23.507 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext fromArray: 1
22:41:23.508 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext fromArray: 3
22:41:23.508 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext fromArray: 5
22:41:23.508 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext filter: 5
22:41:23.508 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext fromArray: 7
22:41:23.508 [boundedElastic-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext filter: 7
22:41:23.508 [parallel-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext map: 50
22:41:23.508 [parallel-1] INFO reactive.schedule.MultiplePublishOnEx -- # onNext: 50
22:41:23.508 [parallel-1] INFO reactive.schedule.MultiplePublishOnEx -- # doOnNext map: 70
22:41:23.508 [parallel-1] INFO reactive.schedule.MultiplePublishOnEx -- # onNext: 70
```

ë³´ë©´ ì‹¤ì œ ê·¸ë¦¼ê³¼ ê²°ê³¼ê°€ ê°™ìŒì„ ë³¼ìˆ˜ê°€ ìˆë‹¤. ë©”ì¸ ì“°ë ˆë“œì—ì„œ `boundedElastic-1` ê·¸ë¦¬ê³  `parallel-1` ì“°ë ˆë“œë¡œ ë³€ê²½ëœ ëª¨ìŠµì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

ì´í›„ ë¡œê·¸ë¥¼ ë³´ë©´ `publishOn()` ê³¼ `subscribeOn()`ì„ ê°™ì´ ì¼ì„ ë•Œë„ ë§ˆì°¬ê°€ì§€ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.

<p align="center">
    <img src="https://i.imgur.com/3hlB23K.png">
</p>
<p align="center">
    <em>ê·¸ë¦¼ 10. subscribeOnê³¼ publishOnì„ ì ìš©í•œ ê²½ìš°</em>
</p>


+ ì˜ˆì‹œ ì½”ë“œ 

```java
public static void main(String[] args) throws InterruptedException {  
	Flux.fromArray(new Integer[]{1, 3, 5, 7})  
		.doOnSubscribe(subscription -> log.info("# doOnSubscribe"))  
		.subscribeOn(Schedulers.boundedElastic())  
			.doOnNext(data -> log.info("# doOnNext fromArray: {}", data))  
		.filter(data -> data > 3)  
			.doOnNext(data -> log.info("# doOnNext filter: {}", data))  
		.publishOn(Schedulers.parallel())  
			.map(data -> data * 10)  
			.doOnNext(data -> log.info("# doOnNext map: {}", data))  
		.subscribe(data -> log.info("# onNext: {}", data));  
  
	Thread.sleep(500L);  
}
```

+ ê²°ê³¼

```sh
22:44:09.965 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnSubscribe
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext fromArray: 1
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext fromArray: 3
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext fromArray: 5
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext filter: 5
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext fromArray: 7
22:44:09.967 [boundedElastic-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext filter: 7
22:44:09.967 [parallel-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext map: 50
22:44:09.968 [parallel-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # onNext: 50
22:44:09.968 [parallel-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # doOnNext map: 70
22:44:09.968 [parallel-1] INFO reactive.schedule.SubscribeOnAndPublishOnEx -- # onNext: 70
```

`subscibeOn()` ë©”ì„œë“œëŠ” êµ¬ë…ì´ ë°œìƒí•œ ì§í›„ì— ì“°ë ˆë“œë¥¼ ì§€ì •í•˜ëŠ” ì—°ì‚°ìë¡œ `doOnSubscribe` ìì²´ê°€ `boundedElastic-1` ì“°ë ˆë“œì—ì„œ ìˆ˜í–‰ë˜ê³  `publishOn()` ë©”ì„œë“œë¥¼ ë§Œë‚˜ ë‹¤ì‹œ `parallel-1` ì“°ë ˆë“œë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ê°€ ìˆë‹¤.

ì´ëŸ¬í•œ ë°©ì‹ì„ í† ëŒ€ë¡œ ì„œë‘ì— ì–˜ê¸°í–ˆë˜ ì½œë°± ë°©ì‹ê³¼ ë‹¤ë¥´ê²Œ `Schedulers` ì—ì„œ ì œê³µí•˜ëŠ” ì“°ë ˆë“œë¥¼ í†µí•´ì„œ ê° ì—°ì‚°ë§ˆë‹¤ ì›í•˜ëŠ” ì“°ë ˆë“œì— ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆê³  ì´ëŠ” ê°œë°œìì˜ ë©€í‹° ì“°ë ˆë”© í•¸ë“¤ë§ì— ëŒ€í•œ ë²ˆê±°ë¡œì›€ì„ ë§ì´ ì¤„ì—¬ì£¼ì—ˆë‹¤.

ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì œê³µí•˜ëŠ” ì“°ë ˆë“œì˜ ì¢…ë¥˜ì— ëŒ€í•´ì„œ ì„¤ëª…í•˜ê³  í¬ìŠ¤íŒ…ì„ ë§ˆë¬´ë¦¬ë¥¼ ì§“ê² ë‹¤.

### STEP 3.4.2 ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ì¢…ë¥˜

ì¢…ë¥˜ì— ëŒ€í•´ì„œ ê°„ë‹¨í•œ íŠ¹ì§•ê³¼ ì„ ì–¸ ë°©ë²•ì—ì„œ í‘œë¡œ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê³  ì„¤ëª…ì„ í•˜ê³ ì í•œë‹¤.
ì—¬ê¸°ì„œ ì„ ì–¸ ë°©ë²• ì˜ˆì‹œëŠ” `publishOn()` ìœ¼ë¡œ í†µì¼í•˜ì˜€ëŠ”ë° ë‹¤ë¥¸ ì—°ì‚°ìë¡œë„ ì„ ì–¸í•  ìˆ˜ ìˆìœ¼ë‚˜ í¸ì˜ë¥¼ ìœ„í•´ì„œ í†µì¼í•˜ì˜€ë‹¤.

| ì¢…ë¥˜                               | íŠ¹ì§•                                                                                                                               | ì„ ì–¸ ë°©ë²• ì˜ˆì‹œ                           |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- |
| `Schedulers.immediate()`           | ë³„ë„ì˜ ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  í˜„ì¬ ì“°ë ˆë“œì—ì„œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ìŠ¤ì¼€ì¤„ëŸ¬                                                             | `.publishOn(Schedulers.immediate())`     |
| `Schedulers.single()`              | ì“°ë ˆë“œë¥¼ 1ê°œë§Œ ìƒì„±í•˜ì—¬ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì œê±°ë˜ê¸° ì „ê¹Œì§€ ì¬ì‚¬ìš©í•˜ëŠ” ë°©ì‹                                                                 | `.publishOn(Schedulers.single())`        |
| `Schedulers.newSingle()`           | `Schedulers.single()` ì€ 1ê°œì˜ ì“°ë ˆë“œë¥¼ ì¬ì‚¬ìš©í•˜ì§€ë§Œ `Schedulers.newSingle()` ëŠ” í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ì“°ë ˆë“œë¥¼ 1ê°œì”© ìƒì„±í•˜ëŠ” ë°©ì‹ | `.publishOn(Schedulers.newSingle(String name, boolean daemon))`     |
| `Schedulers.boundedElastic()`      | `ExecutorService` ê¸°ë°˜ì˜ ì“°ë ˆë“œ í’€ì„ ìƒì„±í•œ í›„ í•´ë‹¹ í’€ì˜ ì“°ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬í•˜ê³  ì¬ì‚¬ìš©í•˜ëŠ” ë°©ì‹                                | `.publishOn(Schedulers.boundedElastic()` |
| `Schedulers.parallel()`            | CPU ì½”ì–´ ìˆ˜ë§Œí¼ì˜ ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ëŠ” ë°©ì‹                                                                                           | `.publishOn(Schedulers.parallel()`       |
| `Schedulers.fromExecutorService()` | ê¸°ì¡´ì— ì‚¬ìš©í•˜ê³  ìˆë˜ `ExecutorService`ê°€ ìˆë‹¤ë©´ ì´ê²ƒì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹(ë¦¬ì•¡í„°ì—ì„œëŠ” `ExecutorService` ì§ì ‘ ìƒì„±ì€ ê¶Œì¥í•˜ì§€ ì•ŠìŒ)     | `.publishOn(Schedulers.fromExecutorService()`                                         |


ì´ ìŠ¤ì¼€ì¤„ëŸ¬ì— ë”°ë¥¸ ë™ì‘ ì˜ˆì‹œ ì½”ë“œëŠ” ë§ì€ë°ì„œ ì–»ì„ ìˆ˜ ìˆìœ¼ë‹ˆ ìœ„ì— ë‚˜ì˜¨ ìŠ¤ì¼€ì¤„ëŸ¬ ì¤‘ì— ë¶€ì—°ì„¤ëª…ì´ í•„ìš”í•œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ëŒ€í•œ ë‚´ìš©ë§Œ ì¶”ê°€í•˜ê³  ë§ˆë¬´ë¦¬ë¥¼ ì§“ê³ ì í•œë‹¤.

1. `Schedulers.immediate()` : ì´ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì£¼ë¡œ ì‚¬ìš©í•  ë•ŒëŠ” `publishOn()` ë©”ì„œë“œë¡œ ë‹¤ë¥¸ ì“°ë ˆë“œì—ì„œ ì‘ì—…í•˜ë˜ ë‚´ìš©ì„ ì›ë˜ ì‹¤í–‰ë˜ë˜ ì“°ë ˆë“œì—ì„œ ìˆ˜í–‰í•˜ê³ ìí•  ë•Œ ì“°ì¼ ìˆ˜ ìˆë‹¤.
2. `Schedulers.newSingle(String name, boolean daemon)` :  `newSingle()` ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ì¶”ê°€ë˜ëŠ” ì“°ë ˆë“œë¥¼ ë°ëª¬ ì“°ë ˆë“œë¡œ ë™ì‘í• ì§€ ì•ˆí• ì§€ ì—¬ë¶€ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ë°ëª¬ ì“°ë ˆë“œëŠ” ì£¼ ì“°ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ ìë™ ì¢…ë£Œë˜ëŠ” íŠ¹ì„±ì´ ìˆë‹¤. 
3. `Schedulers.boundedElastic()` : ì“°ë ˆë“œ í’€ì„ ìƒì„±í•˜ì—¬ í•´ë‹¹ ì“°ë ˆë“œ í’€ì—ì„œ ì“°ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê³  ì¢…ë£Œ ì´í›„ì— ì¬ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ê¸° ë•Œë¬¸ì— ë¸”ë¡í‚¹ I/O ì‘ì—…ì— ìœ ìš©í•œë° ë³„ë„ ì“°ë ˆë“œ í’€ì— ê²©ë¦¬ê°€ ë˜ê¸° ë–„ë¬¸ì— ë‹¤ë¥¸ ë…¼ë¸”ë¡í‚¹ ì‘ì—…ì— ì˜í–¥ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.
4. `Schedulers.parallel()` : CPU ì½”ì–´ ìˆ˜ë§Œí¼ ì“°ë ˆë“œê°€ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ì´ëŠ” ë…¼ë¸”ë¡í‚¹ ì‘ì—…ì— íŠ¹í™”ë˜ì–´ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. 

# ê²°ë¡ 

ì›ë˜ë¼ë©´ `Context`ë„ ë‹¤ë£¨ê³ ìí–ˆëŠ”ë° ì´ëŠ” ë‚˜ì¤‘ì— `WebFlux`ì™€ `Netty`ë¥¼ ë‹¤ë£° ë•Œ ì„¤ëª…ì„ í•´ë³´ê³ ì í•œë‹¤.
ì´ë²ˆ í¬ìŠ¤íŒ…ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ì.

ë¨¼ì €, ë¦¬ì•¡í‹°ë¸Œ ì‹œìŠ¤í…œì´ ì–´ë–¤ ê²ƒì¸ì§€ì™€ ì™œ ëŒ€ë‘ê°€ ë˜ì—ˆëŠ”ì§€ ê·¸ë¦¬ê³  ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•´ì„œ ì—­ì‚¬ì™€ í•¨ê»˜ ì„¤ëª…ì„ í•˜ì˜€ë‹¤.
ê·¸ ì´í›„ì— ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆë¼ëŠ” í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•´ì„œë„ ì™œ íƒ„ìƒí–ˆëŠ”ì§€ ì•Œê²Œë˜ì—ˆë‹¤.

ìš°ë¦¬ëŠ” ê·¸ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ì¦ˆ êµ¬í˜„ì²´ ì¤‘ì— í”„ë¡œì íŠ¸ ë¦¬ì•¡í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê° êµ¬ì„±ìš”ì†Œì™€ íŠ¹ì„±ë“¤ì„ ì•Œì•„ë³´ì•˜ë‹¤.

ìš”ì¦˜ ë¦¬ì•¡í‹°ë¸ŒëŠ” ì–´ë–»ê²Œ ë³´ë©´ ìœ„ê¸°ë¼ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. 
ì›¹ í”ŒëŸ­ìŠ¤ì—ì„œë„ ë§ì€ ê°œë°œìë“¤ì€ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•´ ìµìˆ™í•˜ì§€ ì•Šë‹¤ë³´ë‹ˆ ì½”ë£¨í‹´[^14]ì„ í™œìš©í•˜ì—¬ í•´ë‹¹ ì‘ì—…ë“¤ì„ ì²˜ë¦¬ë¥¼ í•˜ê³  ìˆê³ , Java21ë¶€í„°ëŠ” ê°€ìƒ ì“°ë ˆë“œ[^15]ê°€ ë„ì…ë  ê²ƒì´ë¼ ë¦¬ì•¡í‹°ë¸ŒëŠ” ì–´ë–»ê²Œ ë³´ë©´ ì‚¬ì¥ë  ìˆ˜ ìˆë‹¤ëŠ” ì˜ê²¬ë“¤ì´ ë§ë‹¤.

í•˜ì§€ë§Œ, ê·¸ëŸ¼ì—ë„ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì€ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì„ ì²˜ë¦¬, ë³€í™˜ë“±ì˜ ì‘ì—…ì„ í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ëŠ” ê°•ë ¥í•  ê²ƒìœ¼ë¡œ ìƒê°í•œë‹¤.
ì˜¤íˆë ¤ ì½”ë£¨í‹´ì´ë‚˜ ê°€ìƒì“°ë ˆë“œë¥¼ í†µí•´ì„œ ê¸°ì¡´ ëª…ë ¹í˜• í”„ë¡œê·¸ë˜ë°ì˜ ì¥ì ê³¼ ë¦¬ì•¡í‹°ë¸Œ í”„ë¡œê·¸ë˜ë°ì˜ ì¥ì ì´ ê²°í•©ë˜ì„œ ë³¸ë˜ì˜ ëŸ¬ë‹ì»¤ë¸Œê°€ ì¤„ì–´ë“¤ ìˆ˜ ìˆì§€ì•Šì„ê¹Œ? ìƒê°í•´ë³´ë©´ì„œ ê¸€ì„ ë§ˆì¹œë‹¤.





# ë ˆí¼ëŸ°ìŠ¤

1. [Thread per request VS EventLoop Model in Spring - velog](https://velog.io/@jihoson94/EventLoopModelInSpring)
2. [Servlet and Reactive Stacks in Spring Framework 5 - infoq](https://www.infoq.com/articles/Servlet-and-Reactive-Stacks-Spring-Framework-5/)
3. [Spring MVC Async vs Spring WebFlux - baeldug](https://www.baeldung.com/spring-mvc-async-vs-webflux)
4. [Servlet 3.0, 3.1 ê·¸ë¦¬ê³  ìŠ¤í”„ë§ MVC - í•˜ëì˜ ê¸°ë¡](https://hadev.tistory.com/29)
5. [Imperative vs Declarative Programming in JavaScript - linkdin](https://www.linkedin.com/pulse/imperative-vs-declarative-programming-javascript-yehuda-margolis/)
6. [Armeriaë¡œ Reactive Streamsì™€ ë†€ì! - 1 - LINE Engineering](https://engineering.linecorp.com/ko/blog/reactive-streams-with-armeria-1)
7. [Java Virtual Threads í›‘ì–´ë³´ê¸° - ì˜¤ëŠ˜ë„ ë„ì ë„ì ](https://perfectacle.github.io/2022/12/29/look-over-java-virtual-threads/)
8. [Going Reactive with Spring, Coroutines and Kotlin Flow - spring.io](https://spring.io/blog/2019/04/12/going-reactive-with-spring-coroutines-and-kotlin-flow)

[^1]: [Master/slave (technology)](https://en.wikipedia.org/wiki/Master/slave_(technology))
[^2]: [Project Reactor](https://projectreactor.io/)
[^3]: [Spring Cloud Stream](https://spring.io/projects/spring-cloud-stream)
[^4]: [Spring WebFlux](https://docs.spring.io/spring-framework/reference/web/webflux.html)
[^5]: [CompletionStage - oracle docs](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletionStage.html)
[^6]: [AsyncRestTempalte - spring docs](https://docs.spring.io/spring-framework/docs/4.2.4.RELEASE_to_4.2.5.RELEASE/Spring%20Framework%204.2.5.RELEASE/org/springframework/web/client/AsyncRestTemplate.html)
[^7]: [Thread per request VS EventLoop Model in Spring - velog](https://velog.io/@jihoson94/EventLoopModelInSpring)
[^8]: [Webclient - spring docs](https://docs.spring.io/spring-framework/docs/5.0.0.M2/javadoc-api/org/springframework/web/client/reactive/WebClient.html)
[^9]: [Servlet 3.0, 3.1 ê·¸ë¦¬ê³  ìŠ¤í”„ë§ MVC - í•˜ëì˜ ê¸°ë¡](https://hadev.tistory.com/29)
[^10]: [ReactiveX](https://reactivex.io/)
[^11]: [RxJava](https://github.com/ReactiveX/RxJava)
[^12]: [LambdaSubscriber - github](https://github.com/reactor/reactor-core/blob/main/reactor-core/src/main/java/reactor/core/publisher/LambdaSubscriber.java)
[^13]: [Producerâ€“consumer problem - wikipedia](https://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem)
[^14]: [coroutine - kotlin docs](https://kotlinlang.org/docs/coroutines-overview.html )
[^15]: [Virtual Thread - openJDK](https://openjdk.org/jeps/425)
